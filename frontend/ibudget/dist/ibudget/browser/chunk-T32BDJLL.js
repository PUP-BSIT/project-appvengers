import{a as $}from"./chunk-RZU52TYJ.js";import{d as V,e as R}from"./chunk-6ODX6TS2.js";import{a as L}from"./chunk-HPCBQTSM.js";import"./chunk-NYHJAWNZ.js";import{a as y,b as l,c as w,d as h,g as E,h as F,i as q,j as N,k as D,l as A,m as k,q as T,s as G}from"./chunk-R4J5TFSL.js";import"./chunk-H4HKKKHV.js";import{B as O,C as b,z as P}from"./chunk-OQ6H4KVU.js";import{$a as S,Fb as x,Gb as C,La as f,Pb as r,U as _,ha as v,nb as g,ob as m,tb as M,ub as o,vb as t,wb as u}from"./chunk-DFJZCQ6A.js";import"./chunk-DAQOROHW.js";function Y(e,n){e&1&&(o(0,"div",8),r(1," Saving Name is required. "),t())}function H(e,n){e&1&&(o(0,"div",8),r(1," Target Amount is required. "),t())}function W(e,n){e&1&&(o(0,"div",8),r(1," Target Amount must be at least 1. "),t())}function j(e,n){if(e&1&&g(0,H,2,0,"div",8)(1,W,2,0,"div",8),e&2){let i,a=C();m(!((i=a.addSavingForm.get("target_amount"))==null||i.errors==null)&&i.errors.required?0:!((i=a.addSavingForm.get("target_amount"))==null||i.errors==null)&&i.errors.min?1:-1)}}function z(e,n){e&1&&(o(0,"div",8),r(1," Frequency is required. "),t())}function U(e,n){e&1&&(o(0,"div",8),r(1," Goal Date is required. "),t())}function J(e,n){e&1&&(o(0,"div",8),r(1," Goal Date must be in the future. "),t())}function K(e,n){if(e&1&&g(0,U,2,0,"div",8)(1,J,2,0,"div",8),e&2){let i,a=C();m(!((i=a.addSavingForm.get("goal_date"))==null||i.errors==null)&&i.errors.required?0:!((i=a.addSavingForm.get("goal_date"))==null||i.errors==null)&&i.errors.pastDate?1:-1)}}function B(e){if(!e.value)return null;let n=new Date(e.value),i=new Date;return i.setHours(0,0,0,0),n<i?{pastDate:!0}:null}function Q(e){let n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${n}-${i}-${a}`}function X(e,n=!1){if(!e)return"";let i=new Date,a=i.getFullYear();return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:/^\d{4}-\d{2}$/.test(e)?`${e}-01`:/^\d{4}$/.test(e)?parseInt(e,10)===a&&n?Q(i):`${e}-01-01`:""}var I=class e{savingService=_($);activatedRoute=_(P);router=_(O);toastService=_(L);addSavingForm;formBuilder=_(T);currentSaving=v({});savingsLength=v(1);dateNow=new Date().toISOString().split("T")[0];constructor(){this.addSavingForm=this.formBuilder.group({name:["",{validators:[l.required]}],goal_date:[this.dateNow,{validators:[l.required,B]}],frequency:["",{validators:[l.required]}],target_amount:[0,{validators:[l.required,l.min(1)]}],current_amount:[0],description:[""],header_color:[""],created_at:[""],updated_at:[""],deleted_at:[""]})}ngOnInit(){this.getSavingsLength(),this.addSavingForm=this.formBuilder.group({name:["",{validators:[l.required]}],goal_date:[this.dateNow,{validators:[l.required,B]}],frequency:["",{validators:[l.required]}],target_amount:[0,{validators:[l.required,l.min(1)]}],current_amount:[0],description:[""],header_color:[""],created_at:[this.dateNow],updated_at:[this.dateNow],deleted_at:[""]}),this.activatedRoute.queryParams.subscribe(n=>{(n.name||n.targetAmount||n.description)&&(this.prefillFormFromParams(n),this.toastService.info("Bonzi Pre-fill","Please review the form carefully before submitting."))})}prefillFormFromParams(n){let i=n.targetAmount?parseFloat(n.targetAmount):0,a=X(n.goalDate,!1),d=["Daily","Weekly","Monthly"],c="";if(n.frequency){let s=n.frequency.charAt(0).toUpperCase()+n.frequency.slice(1).toLowerCase();d.includes(s)&&(c=s)}let p={name:n.name||"",target_amount:isNaN(i)?0:i,frequency:c,description:n.description||"",goal_date:a||""};this.addSavingForm.patchValue(p)}getSavingsLength(){this.savingService.getSavings().subscribe(n=>{this.savingsLength.set(n.length)})}addSaving(){let n=this.addSavingForm.value;if(!this.addSavingForm.valid){this.addSavingForm.markAllAsTouched(),console.error("Form is invalid");return}this.savingService.addSaving(n).subscribe({next:()=>{this.router.navigate(["/savings"],{state:{toastMessage:"Saving added successfully!",toastType:"success"}})},error:i=>{console.error("Error adding saving:",i),this.router.navigate(["/savings"],{state:{toastMessage:"Error adding saving. Please try again.",toastType:"error"}})}})}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=S({type:e,selectors:[["app-add-saving"]],decls:72,vars:5,consts:[[1,"form-container"],[3,"formGroup"],[1,"first-row"],[1,"mb-3"],["for","saving_name",1,"form-label"],[1,"input-group"],[1,"bi","bi-piggy-bank","input-group-text"],["type","text","id","saving_name","formControlName","name","placeholder","Enter saving name",1,"form-control"],[1,"text-danger","mt-1"],["for","target_amount",1,"form-label"],[1,"input-group-text"],["type","number","id","target_amount","formControlName","target_amount","placeholder","Enter target amount",1,"form-control"],[1,"second-row"],["for","frequency",1,"form-label"],[1,"bi","bi-clock-history","input-group-text"],["id","frequency","formControlName","frequency",1,"form-select"],["value","","disabled","","selected",""],["value","Daily"],["value","Weekly"],["value","Monthly"],["for","goal_date",1,"form-label"],[1,"bi","bi-calendar-event","input-group-text"],["type","date","formControlName","goal_date","id","goal_date",1,"form-control"],["for","header_color",1,"form-label"],["formControlName","header_color","id","header_color",1,"form-select"],["value","bg-dark"],["value","bg-yellow"],["value","bg-danger"],["value","bg-success"],["value","bg-primary"],["for","description",1,"form-label"],["id","description","rows","3","formControlName","description","placeholder","Enter description (optional)",1,"form-control"],["type","button","routerLink","/savings",1,"btn","btn-secondary","mt-2","me-2"],["type","button",1,"btn","btn-primary","mt-2",3,"click"]],template:function(i,a){if(i&1&&(u(0,"app-toggleable-sidebar")(1,"app-header"),o(2,"main")(3,"div",0)(4,"h2"),r(5,"Add New Saving"),t(),o(6,"p"),r(7,"Fill in the details below to create a new saving goal."),t(),o(8,"form",1)(9,"div",2)(10,"div",3)(11,"label",4),r(12,"Saving Name"),t(),o(13,"div",5),u(14,"i",6)(15,"input",7),t(),g(16,Y,2,0,"div",8),t(),o(17,"div",3)(18,"label",9),r(19,"Target Amount"),t(),o(20,"div",5)(21,"span",10),r(22,"\u20B1"),t(),u(23,"input",11),t(),g(24,j,2,1),t()(),o(25,"div",12)(26,"div",3)(27,"label",13),r(28,"Frequency"),t(),o(29,"div",5),u(30,"i",14),o(31,"select",15)(32,"option",16),r(33,"Select frequency"),t(),o(34,"option",17),r(35,"Daily"),t(),o(36,"option",18),r(37,"Weekly"),t(),o(38,"option",19),r(39,"Monthly"),t()()(),g(40,z,2,0,"div",8),t(),o(41,"div",3)(42,"label",20),r(43,"Goal Date"),t(),o(44,"div",5),u(45,"i",21)(46,"input",22),t(),g(47,K,2,1),t()(),o(48,"div",3)(49,"label",23),r(50,"Header Color"),t(),o(51,"select",24)(52,"option",16),r(53,"Select a color"),t(),o(54,"option",25),r(55,"Dark (Default)"),t(),o(56,"option",26),r(57,"Yellow"),t(),o(58,"option",27),r(59,"Red"),t(),o(60,"option",28),r(61,"Green"),t(),o(62,"option",29),r(63,"Blue"),t()()(),o(64,"div")(65,"label",30),r(66,"Description"),t(),u(67,"textarea",31),t(),o(68,"button",32),r(69," Cancel "),t(),o(70,"button",33),x("click",function(){return a.addSaving()}),r(71," Save "),t()()()()),i&2){let d,c,p,s;f(8),M("formGroup",a.addSavingForm),f(8),m((d=a.addSavingForm.get("name"))!=null&&d.touched&&((d=a.addSavingForm.get("name"))!=null&&d.invalid)?16:-1),f(8),m((c=a.addSavingForm.get("target_amount"))!=null&&c.touched&&((c=a.addSavingForm.get("target_amount"))!=null&&c.invalid)?24:-1),f(16),m((p=a.addSavingForm.get("frequency"))!=null&&p.touched&&((p=a.addSavingForm.get("frequency"))!=null&&p.invalid)?40:-1),f(7),m((s=a.addSavingForm.get("goal_date"))!=null&&s.touched&&((s=a.addSavingForm.get("goal_date"))!=null&&s.invalid)?47:-1)}},dependencies:[V,b,G,E,A,k,y,F,D,w,h,q,N,R],styles:["@keyframes _ngcontent-%COMP%_fadeSlideIn{0%{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}main[_ngcontent-%COMP%]{margin-left:80px;background-color:#f9fafb;padding:30px;height:auto;margin-top:70px}.form-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px 30px;border:1px solid #ccc;border-radius:8px;background-color:#f9f9f9}.first-row[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:15px;justify-content:space-between}.first-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:320px}.first-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{width:310px}.first-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::picker(select), .second-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::picker(select){appearance:none;width:320px;overflow:hidden}.first-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::picker(select), .second-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::picker(select){text-overflow:ellipsis;border:0;margin:.4rem 0;box-shadow:0 0 5px #00000026}.first-row[_ngcontent-%COMP%]   option[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-size:14px;padding:8px 12px}@media (max-width: 320px){main[_ngcontent-%COMP%]{margin-left:0;padding:10px}.form-container[_ngcontent-%COMP%]{padding:20px}.first-row[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.first-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:80%}}@media (min-width: 321px) and (max-width: 768px){main[_ngcontent-%COMP%]{margin-left:0;padding:10px}.form-container[_ngcontent-%COMP%]{padding:20px}.first-row[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.first-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .first-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .second-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:80%}}"]})};export{I as AddSaving};
