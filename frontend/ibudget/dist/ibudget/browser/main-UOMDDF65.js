import{c as Qe,d as we,f as se,g as ye}from"./chunk-PT2JM3JA.js";import{a as kn}from"./chunk-3OUOHT5U.js";import{a as xn,b as _n,c as Cn}from"./chunk-J5JG6VFJ.js";import{a as bn,b as Pe,c as We,d as Me}from"./chunk-HPCBQTSM.js";import{a as sn,b as cn,c as F}from"./chunk-NYHJAWNZ.js";import{a as ln,c as pn,f as dn,k as gn,l as hn,m as un,p as mn,r as fn}from"./chunk-R4J5TFSL.js";import{a as E}from"./chunk-H4HKKKHV.js";import{A as on,B as V,E as rn,F as an,b as Ce,c as jt,d as ke,e as Ut,h as X,i as Ht,k as Gt,l as Yt,o as Wt,q as Qt,r as Zt,s as Kt,t as Xt,u as Jt,v as en,w as ve,x as tn,y as nn}from"./chunk-OQ6H4KVU.js";import{$a as H,A as xt,Ab as Vt,Bb as Nt,C as _t,Cb as A,Fb as O,Gb as u,H as Ct,Ha as It,I as Be,Ib as Ue,J as qe,Jb as He,Kb as Ge,L as me,La as p,M as kt,Mb as xe,Nb as L,Ob as Ye,P as U,Pa as At,Pb as f,Qb as D,Ra as be,Rb as ne,S as fe,T as W,U as x,Ua as Rt,V as vt,Wa as Et,Xa as zt,Z as P,_ as M,ac as ie,ba as Pt,bc as _e,c as mt,ca as Mt,cc as Lt,eb as je,f as te,ga as wt,gc as Ft,ha as b,ia as yt,ib as $t,j as re,kc as Bt,la as Ot,lc as ae,mb as Dt,n as Y,nb as S,o as ft,ob as T,pc as qt,rb as Q,sa as St,sb as Z,ta as Tt,tb as w,u as Fe,ub as c,vb as d,w as ue,wb as m,x as bt}from"./chunk-DFJZCQ6A.js";import{a as y,b as z}from"./chunk-DAQOROHW.js";var N=()=>{let i=x(F),e=x(V);return i.getToken()?i.getProfile().pipe(Y(o=>o.success?!0:(i.logout(),e.navigate(["/auth-page"]),!1)),bt(()=>(i.logout(),e.navigate(["/auth-page"]),re(!1)))):(e.navigate(["/auth-page"]),!1)};var vn=i=>{let e=x(F),t=x(V),o=!!i.queryParamMap.get("token");return e.isLoggedIn()||o?!0:t.createUrlTree(["/auth-page"])};var Pn=i=>{let e=x(F),t=x(V),o=!!i.queryParamMap.get("email");return e.isLoggedIn()||o?!0:t.createUrlTree(["/auth-page"])};var Ze=()=>{let i=x(F),e=x(V);return i.isLoggedIn()?(e.navigate(["/dashboard"]),!1):!0};var Mn=[{path:"",loadComponent:()=>import("./chunk-SA2HRI7J.js").then(i=>i.LandingPage),canActivate:[Ze]},{path:"auth-page",loadComponent:()=>import("./chunk-YC6OB77L.js").then(i=>i.AuthPage),canActivate:[Ze]},{path:"auth/callback",loadComponent:()=>import("./chunk-N46IHAEB.js").then(i=>i.AuthCallback)},{path:"email-verified",loadComponent:()=>import("./chunk-6RWW7FUN.js").then(i=>i.EmailVerification),canActivate:[vn]},{path:"forgot-password",loadComponent:()=>import("./chunk-BOIOS525.js").then(i=>i.ForgotPassword)},{path:"reset-password",loadComponent:()=>import("./chunk-VQZX5ANL.js").then(i=>i.ResetPassword)},{path:"setup-account",loadComponent:()=>import("./chunk-CDKNVO7S.js").then(i=>i.SetupAccount)},{path:"resend-verification",loadComponent:()=>import("./chunk-5VYVKNSF.js").then(i=>i.ResendVerification),canActivate:[Pn]},{path:"dashboard",loadComponent:()=>import("./chunk-FBJJXHUT.js").then(i=>i.Dashboard),canActivate:[N]},{path:"transactions",loadComponent:()=>import("./chunk-YWHAURKZ.js").then(i=>i.Transactions),canActivate:[N]},{path:"budgets",loadComponent:()=>import("./chunk-K72HX3J2.js").then(i=>i.Budgets),canActivate:[N]},{path:"budgets/view-budget/:id",loadComponent:()=>import("./chunk-QILBJUB3.js").then(i=>i.ViewBudget)},{path:"savings",loadComponent:()=>import("./chunk-ZIRI5AHW.js").then(i=>i.Savings),canActivate:[N]},{path:"savings/add-saving",loadComponent:()=>import("./chunk-T32BDJLL.js").then(i=>i.AddSaving),canActivate:[N]},{path:"savings/update-saving/:id",loadComponent:()=>import("./chunk-A5OEXOEM.js").then(i=>i.UpdateSaving),canActivate:[N]},{path:"savings/view-saving/:id",loadComponent:()=>import("./chunk-D25E5CIY.js").then(i=>i.ViewSaving),canActivate:[N]},{path:"categories",loadComponent:()=>import("./chunk-Z3KK5UAL.js").then(i=>i.Categories),canActivate:[N]},{path:"reports",loadComponent:()=>import("./chunk-6BYXXQAD.js").then(i=>i.Reports),canActivate:[N]},{path:"notifications",loadComponent:()=>import("./chunk-4Y46I7IL.js").then(i=>i.Notifications),canActivate:[N]},{path:"settings",loadComponent:()=>import("./chunk-EQBWDMSP.js").then(i=>i.Settings),canActivate:[N]},{path:"settings/account/:id",loadComponent:()=>import("./chunk-XDPYSVZA.js").then(i=>i.Account),canActivate:[N]},{path:"settings/security/:id",loadComponent:()=>import("./chunk-D4PC7SYI.js").then(i=>i.Security)},{path:"settings/notifications",loadComponent:()=>import("./chunk-A4K2UMSV.js").then(i=>i.NotificationPreferencesComponent),canActivate:[N]},{path:"**",loadComponent:()=>import("./chunk-X652YFZN.js").then(i=>i.NotFound)}];function Xn(i,e){if(i&1&&(c(0,"div",3),m(1,"div",4),d()),i&2){let t=u(2);p(),xe("width",t.diameter)("height",t.diameter)}}function Jn(i,e){if(i&1&&m(0,"div",5),i&2){let t=u().ngIf,o=u();xe("background",o.color)("height",o.height)("width",t+"%")}}function ei(i,e){if(i&1&&(Vt(0),je(1,Xn,2,4,"div",1)(2,Jn,1,6,"div",2),Nt()),i&2){let t=u();p(),w("ngIf",t.includeSpinner),p(),w("ngIf",t.includeBar)}}var Ke=class{constructor(e={}){this.config=e,this.state={action:null,value:0,initialValue:0},this.requests=null,this.disabled=!1,this.stream$=new te,this._value$=null,this.timer$=t=>{let o=re(t);switch(t.action){case"start":case"increment":case"set":{t.action==="start"&&this.config.latencyThreshold===0&&t.value===0&&(t.value=t.initialValue),this.requests>0&&(o=Fe(this.config.latencyThreshold,250).pipe(Y(n=>z(y({},t),{value:n===0?this.state.value||t.initialValue:this._increment()}))));break}case"complete":case"stop":{o=t.value===0?re(y({},t)):Fe(0,500).pipe(xt(2),Y(n=>({value:n===0?100:0})));break}}return o.pipe(Y(n=>z(y({},n),{action:"set"})),me(n=>this.next(n,!1)))},this.config=y({latencyThreshold:0},e)}get value$(){return this._value$?this._value$:this._value$=this.stream$.pipe(Be(this.state),qe(e=>this.timer$(e)),Ct(),Y(e=>e.value))}start(e=2){this.disabled||this.next({action:"start",initialValue:e})}stop(){this.next({action:"stop"})}complete(){this.next({action:"complete"})}disable(){this.disabled=!0}set(e){this.next({action:"set",value:e})}increment(e=0){this.next({action:"increment",value:e})}next(e,t=!0){switch(e.action){case"start":this.requests=(this.requests||0)+1;break;case"complete":if(this.requests=(this.requests||1)-1,this.requests>0)return;break;case"stop":this.requests=0;break;case"increment":e.value=this._increment(e.value);break}this.state=y(z(y({},this.state),{action:null}),e),t&&this.stream$.next(this.state)}_increment(e=0){let t=this.state.value;return t>=99&&(e=0),e===0&&(t>=0&&t<25?e=Math.random()*3+3:t>=25&&t<65?e=Math.random()*3:t>=65&&t<90?e=Math.random()*2:t>=90&&t<99?e=.5:e=0),e+t}},ti=new fe("LOADING_BAR_CONFIG");var ce=(()=>{let e=class e{get progress$(){return this.value$}constructor(o,n={},r){this.platformId=o,this.config=n,this.zone=r,this.refs={},this.streams$=new te,this.value$=this.streams$.pipe(Be(null),qe(()=>ft(Object.keys(this.refs).map(a=>this.refs[a].value$))),ni(this.zone),Y(a=>Math.max(0,...a)))}start(o=2){this.useRef().start(o)}set(o){this.useRef().set(o)}increment(o){this.useRef().increment(o)}complete(){this.useRef().complete()}stop(){this.useRef().stop()}useRef(o="default"){return this.refs[o]||(this.refs[o]=new Ke(this.config),this.streams$.next(),Ht(this.platformId)||this.refs[o].disable()),this.refs[o]}};e.\u0275fac=function(n){return new(n||e)(W(St),W(ti,8),W(be,8))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function ni(i){return i?e=>new mt(t=>e.subscribe(o=>i.run(()=>t.next(o)),o=>i.run(()=>t.error(o)),()=>i.run(()=>t.complete()))):e=>e}var wn=(()=>{let e=class e{get value$(){return this.ref?this.loader.useRef(this.ref).value$:this.loader.value$}constructor(o){this.loader=o,this.includeSpinner=!0,this.includeBar=!0,this.fixed=!0,this.color="#29d"}};e.\u0275fac=function(n){return new(n||e)(Et(ce))},e.\u0275cmp=H({type:e,selectors:[["ngx-loading-bar"]],hostVars:3,hostBindings:function(n,r){n&2&&(Dt("fixed",r.fixed),xe("color",r.color))},inputs:{includeSpinner:"includeSpinner",includeBar:"includeBar",fixed:"fixed",color:"color",value:"value",ref:"ref",height:"height",diameter:"diameter"},decls:2,vars:3,consts:[[4,"ngIf"],["class","ngx-spinner",4,"ngIf"],["class","ngx-bar",3,"background","height","width",4,"ngIf"],[1,"ngx-spinner"],[1,"ngx-spinner-icon"],[1,"ngx-bar"]],template:function(n,r){n&1&&(je(0,ei,3,2,"ng-container",0),ie(1,"async")),n&2&&w("ngIf",r.value!=null?r.value:_e(1,1,r.value$))},dependencies:[ke,jt],styles:["[_nghost-%COMP%]{position:relative;display:block;pointer-events:none}[_nghost-%COMP%]   .ngx-spinner[_ngcontent-%COMP%]{transition:.35s linear all;display:block;position:absolute;top:5px;left:0}[_nghost-%COMP%]   .ngx-spinner[_ngcontent-%COMP%]   .ngx-spinner-icon[_ngcontent-%COMP%]{width:14px;height:14px;border:solid 2px transparent;border-top-color:inherit;border-left-color:inherit;border-radius:50%;animation:_ngcontent-%COMP%_loading-bar-spinner .4s linear infinite}[_nghost-%COMP%]   .ngx-bar[_ngcontent-%COMP%]{transition:width .35s;position:absolute;top:0;left:0;width:100%;height:2px;border-bottom-right-radius:1px;border-top-right-radius:1px}[dir=rtl]   [_nghost-%COMP%]   .ngx-bar[_ngcontent-%COMP%]{right:0;left:unset}[fixed=true][_nghost-%COMP%]{z-index:10002}[fixed=true][_nghost-%COMP%]   .ngx-bar[_ngcontent-%COMP%]{position:fixed}[fixed=true][_nghost-%COMP%]   .ngx-spinner[_ngcontent-%COMP%]{position:fixed;top:10px;left:10px}[dir=rtl]   [fixed=true][_nghost-%COMP%]   .ngx-spinner[_ngcontent-%COMP%]{right:10px;left:unset}@keyframes _ngcontent-%COMP%_loading-bar-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],changeDetection:0});let i=e;return i})();function oi(i){let e=i.getCurrentNavigation&&i.getCurrentNavigation();return e&&e.extras?e.extras.state:{}}function ri(i,e){return()=>{let t=e.useRef("router");i.events.subscribe(o=>{let n=oi(i);n&&n.ignoreLoadingBar||(o instanceof en&&t.start(),(o instanceof nn||o instanceof ve||o instanceof tn)&&t.complete())})}}function yn(){return{provide:$t,useFactory:ri,deps:[V,ce],multi:!0}}var ai=new Wt(()=>!1),si=(()=>{let e=class e{constructor(o){this.loader=o}intercept(o,n){if(o.context.get(ai)===!0)return n.handle(o);let r=!1,a=this.loader.useRef("http");return n.handle(o).pipe(me(()=>{r||(a.start(),r=!0)}),_t(()=>r&&a.complete()))}};e.\u0275fac=function(n){return new(n||e)(W(ce))},e.\u0275prov=U({token:e,factory:e.\u0275fac});let i=e;return i})();function On(){return{provide:Qt,useClass:si,multi:!0}}var Sn=(i,e)=>{let o=x(F).getToken();return o&&(i=i.clone({setHeaders:{Authorization:`Bearer ${o}`}})),e(i)};var ci="@",li=(()=>{class i{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=x(Pt);loadingSchedulerFn=x(pi,{optional:!0});_engine;constructor(t,o,n,r,a){this.doc=t,this.delegate=o,this.zone=n,this.animationType=r,this.moduleImpl=a}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-YXZGMOTS.js").then(n=>n),o;return this.loadingSchedulerFn?o=this.loadingSchedulerFn(t):o=t(),o.catch(n=>{throw new kt(5300,!1)}).then(({\u0275createEngine:n,\u0275AnimationRendererFactory:r})=>{this._engine=n(this.animationType,this.doc);let a=new r(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(t,o){let n=this.delegate.createRenderer(t,o);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let r=new Xe(n);return o?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let l=a.createRenderer(t,o);r.use(l),this.scheduler??=this.injector.get(yt,null,{optional:!0}),this.scheduler?.notify(10)}).catch(a=>{r.use(n)}),r}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(t){this._engine?.flush(),this.delegate.componentReplaced?.(t)}static \u0275fac=function(o){zt()};static \u0275prov=U({token:i,factory:i.\u0275fac})}return i})(),Xe=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,o,n){this.delegate.insertBefore(e,t,o,n)}removeChild(e,t,o,n){this.delegate.removeChild(e,t,o,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,o,n){this.delegate.setAttribute(e,t,o,n)}removeAttribute(e,t,o){this.delegate.removeAttribute(e,t,o)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,o,n){this.delegate.setStyle(e,t,o,n)}removeStyle(e,t,o){this.delegate.removeStyle(e,t,o)}setProperty(e,t,o){this.shouldReplay(t)&&this.replay.push(n=>n.setProperty(e,t,o)),this.delegate.setProperty(e,t,o)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,o,n){return this.shouldReplay(t)&&this.replay.push(r=>r.listen(e,t,o,n)),this.delegate.listen(e,t,o,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(ci)}},pi=new fe("");function Tn(i="animations"){return At("NgAsyncAnimations"),vt([{provide:Rt,useFactory:(e,t,o)=>new li(e,t,o,i),deps:[Mt,Gt,be]},{provide:Tt,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var In={providers:[wt(),Ft(),Tn(),rn(Mn,an({scrollPositionRestoration:"top"})),_n(xn()),Zt(Kt([Sn]),Xt()),On(),yn(),cn("ngsw-worker.js",{enabled:!qt(),registrationStrategy:"registerWhenStable:30000"})]};function di(i,e){if(i&1&&(c(0,"div",1),f(1),d()),i&2){let t=u();p(),D(t.visualization.title)}}var Oe=class i{visualization;chartData;chartType;chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:8,font:{size:11}}},title:{display:!1}}};defaultColors=["#3498db","#e74c3c","#2ecc71","#f39c12","#9b59b6","#1abc9c","#e67e22","#34495e","#16a085","#c0392b","#27ae60","#d35400"];ngOnChanges(e){e.visualization&&this.visualization&&this.buildChart()}buildChart(){let{type:e,data:t,colors:o}=this.visualization;this.chartType=e;let n=o||this.generateColors(t.labels.length);e==="line"?(this.chartData={labels:t.labels,datasets:[{data:t.values,borderColor:n[0],backgroundColor:this.hexToRgba(n[0],.2),fill:!0,tension:.3}]},this.chartOptions=z(y({},this.chartOptions),{scales:{y:{beginAtZero:!0,ticks:{font:{size:10}}},x:{ticks:{font:{size:10}}}}})):e==="bar"?(this.chartData={labels:t.labels,datasets:[{data:t.values,backgroundColor:n.map(r=>this.hexToRgba(r,.8)),borderColor:n,borderWidth:1}]},this.chartOptions=z(y({},this.chartOptions),{scales:{y:{beginAtZero:!0,ticks:{font:{size:10}}},x:{ticks:{font:{size:10}}}}})):(this.chartData={labels:t.labels,datasets:[{data:t.values,backgroundColor:n,hoverOffset:4}]},this.chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:8,font:{size:11}}}}})}generateColors(e){let t=[];for(let o=0;o<e;o++)t.push(this.defaultColors[o%this.defaultColors.length]);return t}hexToRgba(e,t){if(e.startsWith("rgb"))return e;e=e.replace("#",""),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);let o=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return`rgba(${o}, ${n}, ${r}, ${t})`}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=H({type:i,selectors:[["app-chat-chart"]],inputs:{visualization:"visualization"},features:[Ot],decls:4,vars:4,consts:[[1,"chat-chart-container"],[1,"chart-title"],[1,"chart-wrapper"],["baseChart","",3,"data","type","options"]],template:function(t,o){t&1&&(c(0,"div",0),S(1,di,2,1,"div",1),c(2,"div",2),m(3,"canvas",3),d()()),t&2&&(p(),T(o.visualization.title?1:-1),p(2),w("data",o.chartData)("type",o.chartType)("options",o.chartOptions))},dependencies:[X,Cn],styles:[".chat-chart-container[_ngcontent-%COMP%]{margin-top:12px;padding:12px;background:#fff;border-radius:8px;border:1px solid #e5e7eb;box-shadow:0 1px 3px #00000014}.chat-chart-container[_ngcontent-%COMP%]   .chart-title[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#2c3e50;margin-bottom:10px;text-align:center;padding-bottom:8px;border-bottom:1px solid rgba(229,231,235,.5)}.chat-chart-container[_ngcontent-%COMP%]   .chart-wrapper[_ngcontent-%COMP%]{height:200px;width:100%;position:relative}.chat-chart-container[_ngcontent-%COMP%]   .chart-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{max-width:100%;max-height:100%}@keyframes _ngcontent-%COMP%_chartFadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.chat-chart-container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_chartFadeIn .3s ease-out}"]})};var Se=class i{constructor(e){this.localStorageService=e;this.initializeSpeechAPIs()}recognition=null;recognitionSubject=new te;errorSubject=new te;synthesis=null;currentUtterance=null;isListening=b(!1);isSpeaking=b(!1);isSTTSupported=b(!1);isTTSSupported=b(!1);availableVoices=b([]);currentVoiceName=b("");selectedVoice=null;speechRate=1;speechPitch=1;speechVolume=1;VOICE_STORAGE_KEY="bonzi_selectedVoice";transcript$=this.recognitionSubject.asObservable();error$=this.errorSubject.asObservable();initializeSpeechAPIs(){let e=window.SpeechRecognition||window.webkitSpeechRecognition;e?(this.isSTTSupported.set(!0),this.recognition=new e,this.configureRecognition()):console.warn("Speech Recognition API not supported in this browser"),"speechSynthesis"in window?(this.isTTSSupported.set(!0),this.synthesis=window.speechSynthesis,this.loadVoices(),this.synthesis.onvoiceschanged!==void 0&&(this.synthesis.onvoiceschanged=()=>this.loadVoices())):console.warn("Speech Synthesis API not supported in this browser")}configureRecognition(){this.recognition&&(this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.maxAlternatives=1,this.recognition.onresult=e=>{let t=e.results[e.resultIndex],o=t[0].transcript,n=t.isFinal,r=t[0].confidence;this.recognitionSubject.next({transcript:o,isFinal:n,confidence:r})},this.recognition.onerror=e=>{let t=this.mapSpeechError(e.error);this.errorSubject.next({type:t,message:this.getErrorMessage(t)}),this.isListening.set(!1)},this.recognition.onend=()=>{this.isListening.set(!1)},this.recognition.onstart=()=>{this.isListening.set(!0)})}mapSpeechError(e){switch(e){case"not-allowed":return"permission-denied";case"no-speech":return"no-speech";case"audio-capture":return"audio-capture";case"network":return"network";case"aborted":return"aborted";default:return"unknown"}}getErrorMessage(e){switch(e){case"not-supported":return"Speech recognition is not supported in your browser. Try Chrome or Edge.";case"permission-denied":return"Microphone access was denied. Please allow microphone access to use voice input.";case"no-speech":return"No speech was detected. Please try again.";case"audio-capture":return"No microphone was found. Please check your audio settings.";case"network":return"Network error occurred. Please check your connection.";case"aborted":return"Speech recognition was aborted.";default:return"An error occurred with speech recognition."}}loadVoices(){if(!this.synthesis)return;let e=this.synthesis.getVoices();if(e.length>0){this.availableVoices.set(e);let t=null;if(this.localStorageService.getUserId()!==null?t=this.localStorageService.getItem(this.VOICE_STORAGE_KEY):t=localStorage.getItem(this.VOICE_STORAGE_KEY),t){let n=e.find(r=>r.name===t);if(n){this.selectedVoice=n,this.currentVoiceName.set(n.name);return}}let o=e.find(n=>n.lang==="en-PH")||e.find(n=>n.lang==="fil-PH")||e.find(n=>n.lang.startsWith("en")&&n.name.includes("Google"))||e.find(n=>n.lang.startsWith("en")&&n.localService)||e.find(n=>n.lang.startsWith("en"))||e[0];this.selectedVoice=o,this.currentVoiceName.set(o.name)}}startListening(){if(!this.recognition)return this.errorSubject.next({type:"not-supported",message:this.getErrorMessage("not-supported")}),this.transcript$;if(this.isListening())return this.transcript$;try{this.recognition.start()}catch(e){console.warn("Recognition already started:",e)}return this.transcript$}stopListening(){this.recognition&&this.isListening()&&this.recognition.stop()}toggleListening(){return this.isListening()?this.stopListening():this.startListening(),this.isListening()}setLanguage(e){this.recognition&&(this.recognition.lang=e)}speak(e,t){if(!this.synthesis){console.warn("Text-to-speech not supported");return}this.stopSpeaking();let o=this.cleanTextForSpeech(e);o.trim()&&(this.currentUtterance=new SpeechSynthesisUtterance(o),this.selectedVoice&&(this.currentUtterance.voice=this.selectedVoice),this.currentUtterance.rate=t?.rate??this.speechRate,this.currentUtterance.pitch=t?.pitch??this.speechPitch,this.currentUtterance.volume=t?.volume??this.speechVolume,this.currentUtterance.onstart=()=>{this.isSpeaking.set(!0)},this.currentUtterance.onend=()=>{this.isSpeaking.set(!1),this.currentUtterance=null},this.currentUtterance.onerror=n=>{console.error("TTS Error:",n.error),this.isSpeaking.set(!1),this.currentUtterance=null},this.synthesis.speak(this.currentUtterance))}stopSpeaking(){this.synthesis&&(this.synthesis.cancel(),this.isSpeaking.set(!1),this.currentUtterance=null)}toggleSpeaking(e){this.isSpeaking()?this.stopSpeaking():this.speak(e)}getVoices(){return this.synthesis?this.synthesis.getVoices():[]}setVoice(e,t=!0){this.selectedVoice=e,this.currentVoiceName.set(e.name),t&&(this.localStorageService.getUserId()!==null?this.localStorageService.setItem(this.VOICE_STORAGE_KEY,e.name):localStorage.setItem(this.VOICE_STORAGE_KEY,e.name))}setVoiceByName(e){let t=this.availableVoices().find(o=>o.name===e);return t?(this.setVoice(t),!0):!1}getSelectedVoice(){return this.selectedVoice}setRate(e){this.speechRate=Math.max(.1,Math.min(10,e))}setPitch(e){this.speechPitch=Math.max(0,Math.min(2,e))}setVolume(e){this.speechVolume=Math.max(0,Math.min(1,e))}cleanTextForSpeech(e){return e.replace(/₱(\d+(?:,\d{3})*(?:\.\d{2})?)/g,"$1 Philippine Pesos").replace(/₱/g,"Philippine Pesos").replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F900}-\u{1F9FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{2B00}-\u{2BFF}\u{1F1E6}-\u{1F1FF}]/gu,"").replace(/```[\s\S]*?```/g,"").replace(/`[^`]+`/g,"").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/__([^_]+)__/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/https?:\/\/[^\s]+/g,"").replace(/<[^>]+>/g,"").replace(/[*#_~`]/g,"").replace(/\s+/g," ").trim()}isFullySupported(){return this.isSTTSupported()&&this.isTTSSupported()}getSupportStatus(){return this.isFullySupported()?"full":this.isTTSSupported()?"tts-only":this.isSTTSupported()?"stt-only":"none"}reloadVoices(){this.loadVoices()}ngOnDestroy(){this.stopListening(),this.stopSpeaking(),this.recognitionSubject.complete(),this.errorSubject.complete()}static \u0275fac=function(t){return new(t||i)(W(Pe))};static \u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"})};function it(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ee=it();function Vn(i){ee=i}var ge={exec:()=>null};function _(i,e=""){let t=typeof i=="string"?i:i.source,o={replace:(n,r)=>{let a=typeof r=="string"?r:r.source;return a=a.replace($.caret,"$1"),t=t.replace(n,a),o},getRegex:()=>new RegExp(t,e)};return o}var gi=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),$={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:i=>new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}#`),htmlBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}<(?:[a-z].*>|!--)`,"i")},hi=/^(?:[ \t]*(?:\n|$))+/,ui=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,mi=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,he=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,fi=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ot=/(?:[*+-]|\d{1,9}[.)])/,Nn=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Ln=_(Nn).replace(/bull/g,ot).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),bi=_(Nn).replace(/bull/g,ot).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),rt=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xi=/^[^\n]+/,at=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,_i=_(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",at).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Ci=_(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ot).getRegex(),Ee="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",st=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ki=_("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",st).replace("tag",Ee).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Fn=_(rt).replace("hr",he).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee).getRegex(),vi=_(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Fn).getRegex(),ct={blockquote:vi,code:ui,def:_i,fences:mi,heading:fi,hr:he,html:ki,lheading:Ln,list:Ci,newline:hi,paragraph:Fn,table:ge,text:xi},An=_("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",he).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee).getRegex(),Pi=z(y({},ct),{lheading:bi,table:An,paragraph:_(rt).replace("hr",he).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",An).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee).getRegex()}),Mi=z(y({},ct),{html:_(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",st).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ge,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:_(rt).replace("hr",he).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ln).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()}),wi=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yi=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Bn=/^( {2,}|\\)\n(?!\s*$)/,Oi=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ze=/[\p{P}\p{S}]/u,lt=/[\s\p{P}\p{S}]/u,qn=/[^\s\p{P}\p{S}]/u,Si=_(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,lt).getRegex(),jn=/(?!~)[\p{P}\p{S}]/u,Ti=/(?!~)[\s\p{P}\p{S}]/u,Ii=/(?:[^\s\p{P}\p{S}]|~)/u,Ai=_(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",gi?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Un=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ri=_(Un,"u").replace(/punct/g,ze).getRegex(),Ei=_(Un,"u").replace(/punct/g,jn).getRegex(),Hn="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",zi=_(Hn,"gu").replace(/notPunctSpace/g,qn).replace(/punctSpace/g,lt).replace(/punct/g,ze).getRegex(),$i=_(Hn,"gu").replace(/notPunctSpace/g,Ii).replace(/punctSpace/g,Ti).replace(/punct/g,jn).getRegex(),Di=_("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,qn).replace(/punctSpace/g,lt).replace(/punct/g,ze).getRegex(),Vi=_(/\\(punct)/,"gu").replace(/punct/g,ze).getRegex(),Ni=_(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Li=_(st).replace("(?:-->|$)","-->").getRegex(),Fi=_("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Li).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ie=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Bi=_(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ie).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Gn=_(/^!?\[(label)\]\[(ref)\]/).replace("label",Ie).replace("ref",at).getRegex(),Yn=_(/^!?\[(ref)\](?:\[\])?/).replace("ref",at).getRegex(),qi=_("reflink|nolink(?!\\()","g").replace("reflink",Gn).replace("nolink",Yn).getRegex(),Rn=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,pt={_backpedal:ge,anyPunctuation:Vi,autolink:Ni,blockSkip:Ai,br:Bn,code:yi,del:ge,emStrongLDelim:Ri,emStrongRDelimAst:zi,emStrongRDelimUnd:Di,escape:wi,link:Bi,nolink:Yn,punctuation:Si,reflink:Gn,reflinkSearch:qi,tag:Fi,text:Oi,url:ge},ji=z(y({},pt),{link:_(/^!?\[(label)\]\((.*?)\)/).replace("label",Ie).getRegex(),reflink:_(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ie).getRegex()}),et=z(y({},pt),{emStrongRDelimAst:$i,emStrongLDelim:Ei,url:_(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Rn).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:_(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Rn).getRegex()}),Ui=z(y({},et),{br:_(Bn).replace("{2,}","*").getRegex(),text:_(et.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),Te={normal:ct,gfm:Pi,pedantic:Mi},le={normal:pt,gfm:et,breaks:Ui,pedantic:ji},Hi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},En=i=>Hi[i];function G(i,e){if(e){if($.escapeTest.test(i))return i.replace($.escapeReplace,En)}else if($.escapeTestNoEncode.test(i))return i.replace($.escapeReplaceNoEncode,En);return i}function zn(i){try{i=encodeURI(i).replace($.percentDecode,"%")}catch{return null}return i}function $n(i,e){let t=i.replace($.findPipe,(r,a,l)=>{let s=!1,h=a;for(;--h>=0&&l[h]==="\\";)s=!s;return s?"|":" |"}),o=t.split($.splitPipe),n=0;if(o[0].trim()||o.shift(),o.length>0&&!o.at(-1)?.trim()&&o.pop(),e)if(o.length>e)o.splice(e);else for(;o.length<e;)o.push("");for(;n<o.length;n++)o[n]=o[n].trim().replace($.slashPipe,"|");return o}function pe(i,e,t){let o=i.length;if(o===0)return"";let n=0;for(;n<o;){let r=i.charAt(o-n-1);if(r===e&&!t)n++;else if(r!==e&&t)n++;else break}return i.slice(0,o-n)}function Gi(i,e){if(i.indexOf(e[1])===-1)return-1;let t=0;for(let o=0;o<i.length;o++)if(i[o]==="\\")o++;else if(i[o]===e[0])t++;else if(i[o]===e[1]&&(t--,t<0))return o;return t>0?-2:-1}function Dn(i,e,t,o,n){let r=e.href,a=e.title||null,l=i[1].replace(n.other.outputLinkReplace,"$1");o.state.inLink=!0;let s={type:i[0].charAt(0)==="!"?"image":"link",raw:t,href:r,title:a,text:l,tokens:o.inlineTokens(l)};return o.state.inLink=!1,s}function Yi(i,e,t){let o=i.match(t.other.indentCodeCompensation);if(o===null)return e;let n=o[1];return e.split(`
`).map(r=>{let a=r.match(t.other.beginningSpace);if(a===null)return r;let[l]=a;return l.length>=n.length?r.slice(n.length):r}).join(`
`)}var Ae=class{options;rules;lexer;constructor(i){this.options=i||ee}space(i){let e=this.rules.block.newline.exec(i);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(i){let e=this.rules.block.code.exec(i);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:pe(t,`
`)}}}fences(i){let e=this.rules.block.fences.exec(i);if(e){let t=e[0],o=Yi(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:o}}}heading(i){let e=this.rules.block.heading.exec(i);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let o=pe(t,"#");(this.options.pedantic||!o||this.rules.other.endingSpaceChar.test(o))&&(t=o.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(i){let e=this.rules.block.hr.exec(i);if(e)return{type:"hr",raw:pe(e[0],`
`)}}blockquote(i){let e=this.rules.block.blockquote.exec(i);if(e){let t=pe(e[0],`
`).split(`
`),o="",n="",r=[];for(;t.length>0;){let a=!1,l=[],s;for(s=0;s<t.length;s++)if(this.rules.other.blockquoteStart.test(t[s]))l.push(t[s]),a=!0;else if(!a)l.push(t[s]);else break;t=t.slice(s);let h=l.join(`
`),g=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");o=o?`${o}
${h}`:h,n=n?`${n}
${g}`:g;let k=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(g,r,!0),this.lexer.state.top=k,t.length===0)break;let C=r.at(-1);if(C?.type==="code")break;if(C?.type==="blockquote"){let R=C,I=R.raw+`
`+t.join(`
`),B=this.blockquote(I);r[r.length-1]=B,o=o.substring(0,o.length-R.raw.length)+B.raw,n=n.substring(0,n.length-R.text.length)+B.text;break}else if(C?.type==="list"){let R=C,I=R.raw+`
`+t.join(`
`),B=this.list(I);r[r.length-1]=B,o=o.substring(0,o.length-C.raw.length)+B.raw,n=n.substring(0,n.length-R.raw.length)+B.raw,t=I.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:o,tokens:r,text:n}}}list(i){let e=this.rules.block.list.exec(i);if(e){let t=e[1].trim(),o=t.length>1,n={type:"list",raw:"",ordered:o,start:o?+t.slice(0,-1):"",loose:!1,items:[]};t=o?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=o?t:"[*+-]");let r=this.rules.other.listItemRegex(t),a=!1;for(;i;){let s=!1,h="",g="";if(!(e=r.exec(i))||this.rules.block.hr.test(i))break;h=e[0],i=i.substring(h.length);let k=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,B=>" ".repeat(3*B.length)),C=i.split(`
`,1)[0],R=!k.trim(),I=0;if(this.options.pedantic?(I=2,g=k.trimStart()):R?I=e[1].length+1:(I=e[2].search(this.rules.other.nonSpaceChar),I=I>4?1:I,g=k.slice(I),I+=e[1].length),R&&this.rules.other.blankLine.test(C)&&(h+=C+`
`,i=i.substring(C.length+1),s=!0),!s){let B=this.rules.other.nextBulletRegex(I),gt=this.rules.other.hrRegex(I),ht=this.rules.other.fencesBeginRegex(I),ut=this.rules.other.headingBeginRegex(I),Qn=this.rules.other.htmlBeginRegex(I);for(;i;){let Le=i.split(`
`,1)[0],oe;if(C=Le,this.options.pedantic?(C=C.replace(this.rules.other.listReplaceNesting,"  "),oe=C):oe=C.replace(this.rules.other.tabCharGlobal,"    "),ht.test(C)||ut.test(C)||Qn.test(C)||B.test(C)||gt.test(C))break;if(oe.search(this.rules.other.nonSpaceChar)>=I||!C.trim())g+=`
`+oe.slice(I);else{if(R||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||ht.test(k)||ut.test(k)||gt.test(k))break;g+=`
`+C}!R&&!C.trim()&&(R=!0),h+=Le+`
`,i=i.substring(Le.length+1),k=oe.slice(I)}}n.loose||(a?n.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(a=!0)),n.items.push({type:"list_item",raw:h,task:!!this.options.gfm&&this.rules.other.listIsTask.test(g),loose:!1,text:g,tokens:[]}),n.raw+=h}let l=n.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;n.raw=n.raw.trimEnd();for(let s of n.items){if(this.lexer.state.top=!1,s.tokens=this.lexer.blockTokens(s.text,[]),s.task){if(s.text=s.text.replace(this.rules.other.listReplaceTask,""),s.tokens[0]?.type==="text"||s.tokens[0]?.type==="paragraph"){s.tokens[0].raw=s.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),s.tokens[0].text=s.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let g=this.lexer.inlineQueue.length-1;g>=0;g--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[g].src)){this.lexer.inlineQueue[g].src=this.lexer.inlineQueue[g].src.replace(this.rules.other.listReplaceTask,"");break}}let h=this.rules.other.listTaskCheckbox.exec(s.raw);if(h){let g={type:"checkbox",raw:h[0]+" ",checked:h[0]!=="[ ]"};s.checked=g.checked,n.loose?s.tokens[0]&&["paragraph","text"].includes(s.tokens[0].type)&&"tokens"in s.tokens[0]&&s.tokens[0].tokens?(s.tokens[0].raw=g.raw+s.tokens[0].raw,s.tokens[0].text=g.raw+s.tokens[0].text,s.tokens[0].tokens.unshift(g)):s.tokens.unshift({type:"paragraph",raw:g.raw,text:g.raw,tokens:[g]}):s.tokens.unshift(g)}}if(!n.loose){let h=s.tokens.filter(k=>k.type==="space"),g=h.length>0&&h.some(k=>this.rules.other.anyLine.test(k.raw));n.loose=g}}if(n.loose)for(let s of n.items){s.loose=!0;for(let h of s.tokens)h.type==="text"&&(h.type="paragraph")}return n}}html(i){let e=this.rules.block.html.exec(i);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(i){let e=this.rules.block.def.exec(i);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),o=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:o,title:n}}}table(i){let e=this.rules.block.table.exec(i);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=$n(e[1]),o=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===o.length){for(let a of o)this.rules.other.tableAlignRight.test(a)?r.align.push("right"):this.rules.other.tableAlignCenter.test(a)?r.align.push("center"):this.rules.other.tableAlignLeft.test(a)?r.align.push("left"):r.align.push(null);for(let a=0;a<t.length;a++)r.header.push({text:t[a],tokens:this.lexer.inline(t[a]),header:!0,align:r.align[a]});for(let a of n)r.rows.push($n(a,r.header.length).map((l,s)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:r.align[s]})));return r}}lheading(i){let e=this.rules.block.lheading.exec(i);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(i){let e=this.rules.block.paragraph.exec(i);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(i){let e=this.rules.block.text.exec(i);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(i){let e=this.rules.inline.escape.exec(i);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(i){let e=this.rules.inline.tag.exec(i);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(i){let e=this.rules.inline.link.exec(i);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let r=pe(t.slice(0,-1),"\\");if((t.length-r.length)%2===0)return}else{let r=Gi(e[2],"()");if(r===-2)return;if(r>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+r;e[2]=e[2].substring(0,r),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let o=e[2],n="";if(this.options.pedantic){let r=this.rules.other.pedanticHrefTitle.exec(o);r&&(o=r[1],n=r[3])}else n=e[3]?e[3].slice(1,-1):"";return o=o.trim(),this.rules.other.startAngleBracket.test(o)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?o=o.slice(1):o=o.slice(1,-1)),Dn(e,{href:o&&o.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(i,e){let t;if((t=this.rules.inline.reflink.exec(i))||(t=this.rules.inline.nolink.exec(i))){let o=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=e[o.toLowerCase()];if(!n){let r=t[0].charAt(0);return{type:"text",raw:r,text:r}}return Dn(t,n,t[0],this.lexer,this.rules)}}emStrong(i,e,t=""){let o=this.rules.inline.emStrongLDelim.exec(i);if(!(!o||o[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(o[1]||o[2])||!t||this.rules.inline.punctuation.exec(t))){let n=[...o[0]].length-1,r,a,l=n,s=0,h=o[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*i.length+n);(o=h.exec(e))!=null;){if(r=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!r)continue;if(a=[...r].length,o[3]||o[4]){l+=a;continue}else if((o[5]||o[6])&&n%3&&!((n+a)%3)){s+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+s);let g=[...o[0]][0].length,k=i.slice(0,n+o.index+g+a);if(Math.min(n,a)%2){let R=k.slice(1,-1);return{type:"em",raw:k,text:R,tokens:this.lexer.inlineTokens(R)}}let C=k.slice(2,-2);return{type:"strong",raw:k,text:C,tokens:this.lexer.inlineTokens(C)}}}}codespan(i){let e=this.rules.inline.code.exec(i);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),o=this.rules.other.nonSpaceChar.test(t),n=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return o&&n&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(i){let e=this.rules.inline.br.exec(i);if(e)return{type:"br",raw:e[0]}}del(i){let e=this.rules.inline.del.exec(i);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(i){let e=this.rules.inline.autolink.exec(i);if(e){let t,o;return e[2]==="@"?(t=e[1],o="mailto:"+t):(t=e[1],o=t),{type:"link",raw:e[0],text:t,href:o,tokens:[{type:"text",raw:t,text:t}]}}}url(i){let e;if(e=this.rules.inline.url.exec(i)){let t,o;if(e[2]==="@")t=e[0],o="mailto:"+t;else{let n;do n=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(n!==e[0]);t=e[0],e[1]==="www."?o="http://"+e[0]:o=e[0]}return{type:"link",raw:e[0],text:t,href:o,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(i){let e=this.rules.inline.text.exec(i);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},q=class tt{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ee,this.options.tokenizer=this.options.tokenizer||new Ae,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:$,block:Te.normal,inline:le.normal};this.options.pedantic?(t.block=Te.pedantic,t.inline=le.pedantic):this.options.gfm&&(t.block=Te.gfm,this.options.breaks?t.inline=le.breaks:t.inline=le.gfm),this.tokenizer.rules=t}static get rules(){return{block:Te,inline:le}}static lex(e,t){return new tt(t).lex(e)}static lexInline(e,t){return new tt(t).inlineTokens(e)}lex(e){e=e.replace($.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let o=this.inlineQueue[t];this.inlineTokens(o.src,o.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],o=!1){for(this.options.pedantic&&(e=e.replace($.tabCharGlobal,"    ").replace($.spaceLine,""));e;){let n;if(this.options.extensions?.block?.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);let a=t.at(-1);n.raw.length===1&&a!==void 0?a.raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);let a=t.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+n.raw,a.text+=`
`+n.text,this.inlineQueue.at(-1).src=a.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);let a=t.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+n.raw,a.text+=`
`+n.raw,this.inlineQueue.at(-1).src=a.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title},t.push(n));continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}let r=e;if(this.options.extensions?.startBlock){let a=1/0,l=e.slice(1),s;this.options.extensions.startBlock.forEach(h=>{s=h.call({lexer:this},l),typeof s=="number"&&s>=0&&(a=Math.min(a,s))}),a<1/0&&a>=0&&(r=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(r))){let a=t.at(-1);o&&a?.type==="paragraph"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+n.raw,a.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(n),o=r.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);let a=t.at(-1);a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+n.raw,a.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(n);continue}if(e){let a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let o=e,n=null;if(this.tokens.links){let s=Object.keys(this.tokens.links);if(s.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)s.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,n.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let r;for(;(n=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)r=n[2]?n[2].length:0,o=o.slice(0,n.index+r)+"["+"a".repeat(n[0].length-r-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);o=this.options.hooks?.emStrongMask?.call({lexer:this},o)??o;let a=!1,l="";for(;e;){a||(l=""),a=!1;let s;if(this.options.extensions?.inline?.some(g=>(s=g.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.escape(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.tag(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.link(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(s.raw.length);let g=t.at(-1);s.type==="text"&&g?.type==="text"?(g.raw+=s.raw,g.text+=s.text):t.push(s);continue}if(s=this.tokenizer.emStrong(e,o,l)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.codespan(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.br(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.del(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.autolink(e)){e=e.substring(s.raw.length),t.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(e))){e=e.substring(s.raw.length),t.push(s);continue}let h=e;if(this.options.extensions?.startInline){let g=1/0,k=e.slice(1),C;this.options.extensions.startInline.forEach(R=>{C=R.call({lexer:this},k),typeof C=="number"&&C>=0&&(g=Math.min(g,C))}),g<1/0&&g>=0&&(h=e.substring(0,g+1))}if(s=this.tokenizer.inlineText(h)){e=e.substring(s.raw.length),s.raw.slice(-1)!=="_"&&(l=s.raw.slice(-1)),a=!0;let g=t.at(-1);g?.type==="text"?(g.raw+=s.raw,g.text+=s.text):t.push(s);continue}if(e){let g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return t}},Re=class{options;parser;constructor(i){this.options=i||ee}space(i){return""}code({text:i,lang:e,escaped:t}){let o=(e||"").match($.notSpaceStart)?.[0],n=i.replace($.endingNewline,"")+`
`;return o?'<pre><code class="language-'+G(o)+'">'+(t?n:G(n,!0))+`</code></pre>
`:"<pre><code>"+(t?n:G(n,!0))+`</code></pre>
`}blockquote({tokens:i}){return`<blockquote>
${this.parser.parse(i)}</blockquote>
`}html({text:i}){return i}def(i){return""}heading({tokens:i,depth:e}){return`<h${e}>${this.parser.parseInline(i)}</h${e}>
`}hr(i){return`<hr>
`}list(i){let e=i.ordered,t=i.start,o="";for(let a=0;a<i.items.length;a++){let l=i.items[a];o+=this.listitem(l)}let n=e?"ol":"ul",r=e&&t!==1?' start="'+t+'"':"";return"<"+n+r+`>
`+o+"</"+n+`>
`}listitem(i){return`<li>${this.parser.parse(i.tokens)}</li>
`}checkbox({checked:i}){return"<input "+(i?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:i}){return`<p>${this.parser.parseInline(i)}</p>
`}table(i){let e="",t="";for(let n=0;n<i.header.length;n++)t+=this.tablecell(i.header[n]);e+=this.tablerow({text:t});let o="";for(let n=0;n<i.rows.length;n++){let r=i.rows[n];t="";for(let a=0;a<r.length;a++)t+=this.tablecell(r[a]);o+=this.tablerow({text:t})}return o&&(o=`<tbody>${o}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+o+`</table>
`}tablerow({text:i}){return`<tr>
${i}</tr>
`}tablecell(i){let e=this.parser.parseInline(i.tokens),t=i.header?"th":"td";return(i.align?`<${t} align="${i.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:i}){return`<strong>${this.parser.parseInline(i)}</strong>`}em({tokens:i}){return`<em>${this.parser.parseInline(i)}</em>`}codespan({text:i}){return`<code>${G(i,!0)}</code>`}br(i){return"<br>"}del({tokens:i}){return`<del>${this.parser.parseInline(i)}</del>`}link({href:i,title:e,tokens:t}){let o=this.parser.parseInline(t),n=zn(i);if(n===null)return o;i=n;let r='<a href="'+i+'"';return e&&(r+=' title="'+G(e)+'"'),r+=">"+o+"</a>",r}image({href:i,title:e,text:t,tokens:o}){o&&(t=this.parser.parseInline(o,this.parser.textRenderer));let n=zn(i);if(n===null)return G(t);i=n;let r=`<img src="${i}" alt="${t}"`;return e&&(r+=` title="${G(e)}"`),r+=">",r}text(i){return"tokens"in i&&i.tokens?this.parser.parseInline(i.tokens):"escaped"in i&&i.escaped?i.text:G(i.text)}},dt=class{strong({text:i}){return i}em({text:i}){return i}codespan({text:i}){return i}del({text:i}){return i}html({text:i}){return i}text({text:i}){return i}link({text:i}){return""+i}image({text:i}){return""+i}br(){return""}checkbox({raw:i}){return i}},j=class nt{options;renderer;textRenderer;constructor(e){this.options=e||ee,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new dt}static parse(e,t){return new nt(t).parse(e)}static parseInline(e,t){return new nt(t).parseInline(e)}parse(e){let t="";for(let o=0;o<e.length;o++){let n=e[o];if(this.options.extensions?.renderers?.[n.type]){let a=n,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(a.type)){t+=l||"";continue}}let r=n;switch(r.type){case"space":{t+=this.renderer.space(r);break}case"hr":{t+=this.renderer.hr(r);break}case"heading":{t+=this.renderer.heading(r);break}case"code":{t+=this.renderer.code(r);break}case"table":{t+=this.renderer.table(r);break}case"blockquote":{t+=this.renderer.blockquote(r);break}case"list":{t+=this.renderer.list(r);break}case"checkbox":{t+=this.renderer.checkbox(r);break}case"html":{t+=this.renderer.html(r);break}case"def":{t+=this.renderer.def(r);break}case"paragraph":{t+=this.renderer.paragraph(r);break}case"text":{t+=this.renderer.text(r);break}default:{let a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return t}parseInline(e,t=this.renderer){let o="";for(let n=0;n<e.length;n++){let r=e[n];if(this.options.extensions?.renderers?.[r.type]){let l=this.options.extensions.renderers[r.type].call({parser:this},r);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){o+=l||"";continue}}let a=r;switch(a.type){case"escape":{o+=t.text(a);break}case"html":{o+=t.html(a);break}case"link":{o+=t.link(a);break}case"image":{o+=t.image(a);break}case"checkbox":{o+=t.checkbox(a);break}case"strong":{o+=t.strong(a);break}case"em":{o+=t.em(a);break}case"codespan":{o+=t.codespan(a);break}case"br":{o+=t.br(a);break}case"del":{o+=t.del(a);break}case"text":{o+=t.text(a);break}default:{let l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return o}},de=class{options;block;constructor(i){this.options=i||ee}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(i){return i}postprocess(i){return i}processAllTokens(i){return i}emStrongMask(i){return i}provideLexer(){return this.block?q.lex:q.lexInline}provideParser(){return this.block?j.parse:j.parseInline}},Wi=class{defaults=it();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=j;Renderer=Re;TextRenderer=dt;Lexer=q;Tokenizer=Ae;Hooks=de;constructor(...i){this.use(...i)}walkTokens(i,e){let t=[];for(let o of i)switch(t=t.concat(e.call(this,o)),o.type){case"table":{let n=o;for(let r of n.header)t=t.concat(this.walkTokens(r.tokens,e));for(let r of n.rows)for(let a of r)t=t.concat(this.walkTokens(a.tokens,e));break}case"list":{let n=o;t=t.concat(this.walkTokens(n.items,e));break}default:{let n=o;this.defaults.extensions?.childTokens?.[n.type]?this.defaults.extensions.childTokens[n.type].forEach(r=>{let a=n[r].flat(1/0);t=t.concat(this.walkTokens(a,e))}):n.tokens&&(t=t.concat(this.walkTokens(n.tokens,e)))}}return t}use(...i){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return i.forEach(t=>{let o=y({},t);if(o.async=this.defaults.async||o.async||!1,t.extensions&&(t.extensions.forEach(n=>{if(!n.name)throw new Error("extension name required");if("renderer"in n){let r=e.renderers[n.name];r?e.renderers[n.name]=function(...a){let l=n.renderer.apply(this,a);return l===!1&&(l=r.apply(this,a)),l}:e.renderers[n.name]=n.renderer}if("tokenizer"in n){if(!n.level||n.level!=="block"&&n.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let r=e[n.level];r?r.unshift(n.tokenizer):e[n.level]=[n.tokenizer],n.start&&(n.level==="block"?e.startBlock?e.startBlock.push(n.start):e.startBlock=[n.start]:n.level==="inline"&&(e.startInline?e.startInline.push(n.start):e.startInline=[n.start]))}"childTokens"in n&&n.childTokens&&(e.childTokens[n.name]=n.childTokens)}),o.extensions=e),t.renderer){let n=this.defaults.renderer||new Re(this.defaults);for(let r in t.renderer){if(!(r in n))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;let a=r,l=t.renderer[a],s=n[a];n[a]=(...h)=>{let g=l.apply(n,h);return g===!1&&(g=s.apply(n,h)),g||""}}o.renderer=n}if(t.tokenizer){let n=this.defaults.tokenizer||new Ae(this.defaults);for(let r in t.tokenizer){if(!(r in n))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;let a=r,l=t.tokenizer[a],s=n[a];n[a]=(...h)=>{let g=l.apply(n,h);return g===!1&&(g=s.apply(n,h)),g}}o.tokenizer=n}if(t.hooks){let n=this.defaults.hooks||new de;for(let r in t.hooks){if(!(r in n))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;let a=r,l=t.hooks[a],s=n[a];de.passThroughHooks.has(r)?n[a]=h=>{if(this.defaults.async&&de.passThroughHooksRespectAsync.has(r))return(async()=>{let k=await l.call(n,h);return s.call(n,k)})();let g=l.call(n,h);return s.call(n,g)}:n[a]=(...h)=>{if(this.defaults.async)return(async()=>{let k=await l.apply(n,h);return k===!1&&(k=await s.apply(n,h)),k})();let g=l.apply(n,h);return g===!1&&(g=s.apply(n,h)),g}}o.hooks=n}if(t.walkTokens){let n=this.defaults.walkTokens,r=t.walkTokens;o.walkTokens=function(a){let l=[];return l.push(r.call(this,a)),n&&(l=l.concat(n.call(this,a))),l}}this.defaults=y(y({},this.defaults),o)}),this}setOptions(i){return this.defaults=y(y({},this.defaults),i),this}lexer(i,e){return q.lex(i,e??this.defaults)}parser(i,e){return j.parse(i,e??this.defaults)}parseMarkdown(i){return(e,t)=>{let o=y({},t),n=y(y({},this.defaults),o),r=this.onError(!!n.silent,!!n.async);if(this.defaults.async===!0&&o.async===!1)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return r(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=i),n.async)return(async()=>{let a=n.hooks?await n.hooks.preprocess(e):e,l=await(n.hooks?await n.hooks.provideLexer():i?q.lex:q.lexInline)(a,n),s=n.hooks?await n.hooks.processAllTokens(l):l;n.walkTokens&&await Promise.all(this.walkTokens(s,n.walkTokens));let h=await(n.hooks?await n.hooks.provideParser():i?j.parse:j.parseInline)(s,n);return n.hooks?await n.hooks.postprocess(h):h})().catch(r);try{n.hooks&&(e=n.hooks.preprocess(e));let a=(n.hooks?n.hooks.provideLexer():i?q.lex:q.lexInline)(e,n);n.hooks&&(a=n.hooks.processAllTokens(a)),n.walkTokens&&this.walkTokens(a,n.walkTokens);let l=(n.hooks?n.hooks.provideParser():i?j.parse:j.parseInline)(a,n);return n.hooks&&(l=n.hooks.postprocess(l)),l}catch(a){return r(a)}}}onError(i,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,i){let o="<p>An error occurred:</p><pre>"+G(t.message+"",!0)+"</pre>";return e?Promise.resolve(o):o}if(e)return Promise.reject(t);throw t}}},J=new Wi;function v(i,e){return J.parse(i,e)}v.options=v.setOptions=function(i){return J.setOptions(i),v.defaults=J.defaults,Vn(v.defaults),v};v.getDefaults=it;v.defaults=ee;v.use=function(...i){return J.use(...i),v.defaults=J.defaults,Vn(v.defaults),v};v.walkTokens=function(i,e){return J.walkTokens(i,e)};v.parseInline=J.parseInline;v.Parser=j;v.parser=j.parse;v.Renderer=Re;v.TextRenderer=dt;v.Lexer=q;v.lexer=q.lex;v.Tokenizer=Ae;v.Hooks=de;v.parse=v;var ra=v.options,aa=v.setOptions,sa=v.use,ca=v.walkTokens,la=v.parseInline;var pa=j.parse,da=q.lex;var Zi=["scrollContainer"],Ki=["textareaRef"],Xi=(i,e)=>e.timestamp,Ji=(i,e)=>e.lang,eo=(i,e)=>e.name,Wn=(i,e)=>e.command;function to(i,e){if(i&1){let t=A();c(0,"button",31),O("click",function(){P(t);let n=u();return M(n.toggleSettings())}),m(1,"i",32),d(),c(2,"button",33),O("click",function(){P(t);let n=u();return M(n.toggleAutoSpeak())}),m(3,"i",34),d()}if(i&2){let t=u();L("active",t.showSettings()),p(2),L("active",t.autoSpeak()),w("title",t.autoSpeak()?"Disable auto-read responses":"Enable auto-read responses"),p(),w("ngClass",t.autoSpeak()?"bi-volume-up-fill":"bi-volume-mute")}}function no(i,e){if(i&1&&(c(0,"option",44),f(1),d()),i&2){let t=e.$implicit;w("value",t.name),p(),ne(" ",t.name," ")}}function io(i,e){if(i&1&&(c(0,"optgroup",40),Q(1,no,2,2,"option",44,eo),d()),i&2){let t=e.$implicit;w("label",t.langName),p(),Z(t.voices)}}function oo(i,e){if(i&1){let t=A();c(0,"div",11)(1,"div",35),m(2,"i",36),c(3,"span"),f(4,"Voice Settings"),d()(),c(5,"div",37)(6,"label",38),f(7,"Select Voice"),d(),c(8,"select",39),O("ngModelChange",function(n){P(t);let r=u();return M(r.selectVoice(n))}),Q(9,io,3,1,"optgroup",40,Ji),d(),c(11,"button",41),O("click",function(){P(t);let n=u();return M(n.previewVoice())}),m(12,"i",34),f(13),d(),c(14,"p",42),m(15,"i",43),f(16," Choose a Philippine English voice for correct peso (\u20B1) pronunciation. "),d()()()}if(i&2){let t=u();p(8),w("ngModel",t.currentVoiceName()),p(),Z(t.getGroupedVoices()),p(2),w("disabled",t.isSpeaking()),p(),w("ngClass",t.isSpeaking()?"bi-stop-fill":"bi-play-fill"),p(),ne(" ",t.isSpeaking()?"Stop":"Preview Voice"," ")}}function ro(i,e){if(i&1&&(c(0,"div",13)(1,"div",45),m(2,"img",46),d(),c(3,"h2",47),f(4),c(5,"span",48),f(6,"|"),d()(),c(7,"p",49),f(8,"Can I help you with anything?"),d(),c(9,"p",50),f(10,"I can perform agentic actions, web search, or show visualization. "),m(11,"br"),f(12," Let me know your thoughts! "),d()()),i&2){let t=u();p(4),D(t.typewriterText())}}function ao(i,e){i&1&&(c(0,"div",52),m(1,"img",60),d())}function so(i,e){if(i&1&&m(0,"app-chat-chart",55),i&2){let t=u().$implicit;w("visualization",t.visualization)}}function co(i,e){if(i&1){let t=A();c(0,"div",56)(1,"button",61),O("click",function(){P(t);let n=u().$implicit,r=u();return M(r.executeAction(n.action))}),m(2,"i",34),c(3,"span"),f(4),d(),m(5,"i",62),d()()}if(i&2){let t=u().$implicit;p(2),w("ngClass",t.action.icon||"bi-arrow-right-circle"),p(2),D(t.action.label||"Take action")}}function lo(i,e){if(i&1){let t=A();c(0,"button",65),O("click",function(){P(t);let n=u(2).$implicit,r=u();return M(r.speakMessage(n.text))}),m(1,"i",34),d()}if(i&2){let t=u(3);w("title",t.isSpeaking()?"Stop speaking":"Read aloud"),p(),w("ngClass",t.isSpeaking()?"bi-stop-fill":"bi-volume-up")}}function po(i,e){if(i&1){let t=A();c(0,"div",59)(1,"button",63),O("click",function(){P(t);let n=u().$implicit,r=u();return M(r.copyMessage(n))}),m(2,"i",34),d(),S(3,lo,2,2,"button",64),d()}if(i&2){let t=u().$implicit,o=u();p(),L("copied",o.copiedMessageId()===t.timestamp.getTime()),w("title",o.copiedMessageId()===t.timestamp.getTime()?"Copied!":"Copy message"),p(),w("ngClass",o.copiedMessageId()===t.timestamp.getTime()?"bi-check-lg":"bi-copy"),p(),T(o.isTTSSupported()?3:-1)}}function go(i,e){if(i&1&&(c(0,"div",51),S(1,ao,2,0,"div",52),c(2,"div",53),m(3,"div",54),S(4,so,1,1,"app-chat-chart",55),S(5,co,6,2,"div",56),c(6,"div",57)(7,"div",58),f(8),ie(9,"date"),d(),S(10,po,4,5,"div",59),d()()()),i&2){let t=e.$implicit,o=u();L("user",t.isUser)("bot",!t.isUser),p(),T(t.isUser?-1:1),p(),L("user",t.isUser)("bot",!t.isUser),p(),w("innerHTML",o.parseMarkdown(t.text),It),p(),T(t.visualization&&!t.isUser?4:-1),p(),T(t.action&&!t.isUser?5:-1),p(3),ne(" ",Lt(9,14,t.timestamp,"shortTime")," "),p(2),T(t.isUser?-1:10)}}function ho(i,e){if(i&1&&(c(0,"div",15)(1,"div",66),m(2,"img",60),d(),c(3,"div",67)(4,"div",68),m(5,"span",69)(6,"span",69)(7,"span",69),d(),c(8,"span",70),f(9),d()()()),i&2){let t=u();p(9),D(t.loadingWord())}}function uo(i,e){if(i&1){let t=A();c(0,"div",16)(1,"button",71),O("click",function(){P(t);let n=u();return M(n.retryLastMessage())}),m(2,"i",72),f(3," Retry "),d()()}}function mo(i,e){if(i&1&&(c(0,"div",18),m(1,"i",73),c(2,"span"),f(3),d()()),i&2){let t=u();p(3),D(t.speechError())}}function fo(i,e){if(i&1&&(c(0,"div",19),m(1,"i",74),c(2,"span"),f(3),d()()),i&2){let t=u();p(3),D(t.liveTranscript())}}function bo(i,e){if(i&1){let t=A();c(0,"button",81),O("click",function(){let n=P(t),r=n.$implicit,a=n.$index,l=u(2);return M(l.selectCommand(r,a))})("mouseenter",function(){let n=P(t).$index,r=u(2);return M(r.selectedCommandIndex.set(n))}),m(1,"i",82),c(2,"div",83)(3,"span",84),f(4),d(),c(5,"span",85),f(6),d()(),c(7,"kbd",86),f(8,"\u21B5"),d()()}if(i&2){let t=e.$implicit,o=e.$index,n=u(2);L("selected",o===n.selectedCommandIndex()),p(),Ye(t.icon),p(3),D(t.command),p(2),D(t.text)}}function xo(i,e){i&1&&(c(0,"div",80),m(1,"i",87),c(2,"span"),f(3,"No commands found"),d()())}function _o(i,e){if(i&1){let t=A();c(0,"div",20)(1,"div",75),m(2,"i",27),c(3,"span"),f(4,"Quick Commands"),d(),c(5,"button",76),O("click",function(){P(t);let n=u();return M(n.closeCommandPalette())}),m(6,"i",77),d()(),c(7,"div",78),Q(8,bo,9,6,"button",79,Wn),d(),S(10,xo,4,0,"div",80),d()}if(i&2){let t=u();p(8),Z(t.filteredCommands()),p(2),T(t.filteredCommands().length===0?10:-1)}}function Co(i,e){if(i&1){let t=A();c(0,"button",89),O("click",function(){let n=P(t).$implicit,r=u(2);return M(r.executeQuickAction(n))}),m(1,"i",82),c(2,"span"),f(3),d()()}if(i&2){let t=e.$implicit;p(),Ye(t.icon),p(2),D(t.text)}}function ko(i,e){if(i&1&&(c(0,"div",21),Q(1,Co,4,3,"button",88,Wn),d()),i&2){let t=u();p(),Z(t.quickActions)}}function vo(i,e){if(i&1){let t=A();c(0,"button",90),O("click",function(){P(t);let n=u();return M(n.toggleRecording())}),m(1,"i",34),d()}if(i&2){let t=u();L("recording",t.isRecording()),w("title",t.isRecording()?"Stop recording":"Voice input")("disabled",t.isLoading()),p(),w("ngClass",t.isRecording()?"bi-mic-fill":"bi-mic")}}var $e=class i{chatbotService=x(Me);speechService=x(Se);sanitizer=x(Jt);router=x(V);localStorageService=x(Pe);speechSubscription=null;errorSubscription=null;typewriterTimeoutId=null;commandPlaceholderInterval=null;isOpen=this.chatbotService.isOpen;isLoading=b(!1);messages=b([]);userInput=b("");loadingWord=b("Thinking...");lastError=b(null);showWelcome=b(!0);userName=b("");typewriterText=b("");showTypewriter=b(!0);isRecording=this.speechService.isListening;isSpeaking=this.speechService.isSpeaking;isSTTSupported=this.speechService.isSTTSupported;isTTSSupported=this.speechService.isTTSSupported;autoSpeak=b(!1);liveTranscript=b("");speechError=b(null);showSettings=b(!1);availableVoices=this.speechService.availableVoices;currentVoiceName=this.speechService.currentVoiceName;copiedMessageId=b(null);showCommandPalette=b(!1);selectedCommandIndex=b(0);filteredCommands=b([]);inputPlaceholder=b("Type a message or / for commands...");currentCommandIndex=0;shouldScrollToBottom=!1;loadedForUserId=null;scrollContainer;textareaRef;funWords=["Thinking...","Processing...","Analyzing...","Computing...","Brainstorming...","Consulting the oracle...","Doing math...","Connecting dots...","Loading wisdom...","Asking the stars..."];quickActions=[{icon:"bi-pie-chart",text:"Show my spending",command:"/spending",prompt:"Show me a breakdown of my spending by category"},{icon:"bi-lightbulb",text:"Budget tips",command:"/tips",prompt:"Give me some budgeting tips for students"},{icon:"bi-plus-circle",text:"How to add transaction",command:"/add",prompt:"How do I add a new transaction?"},{icon:"bi-piggy-bank",text:"Savings advice",command:"/savings",prompt:"How can I save more money?"}];constructor(){ae(()=>{if(this.isLoading()){let e=setInterval(()=>{let t=Math.floor(Math.random()*this.funWords.length);this.loadingWord.set(this.funWords[t])},800);return()=>clearInterval(e)}}),ae(()=>{let e=this.messages(),t=this.localStorageService.getUserId();e.length>0&&t!==null&&this.chatbotService.saveMessages(e)}),ae(()=>{this.isOpen()&&this.loadMessagesIfReady()}),ae(()=>{let e=this.chatbotService.stateVersion();e>0&&(E.production||console.log("[ChatbotSidebar] State reset triggered (version:",e,")"),this.loadedForUserId=null,this.messages.set([]))}),this.speechSubscription=this.speechService.transcript$.subscribe(e=>{if(this.liveTranscript.set(e.transcript),e.isFinal){let t=this.userInput().trim(),o=e.transcript.trim(),n=t?`${t} ${o}`:o;this.userInput.set(n),this.liveTranscript.set("")}}),this.errorSubscription=this.speechService.error$.subscribe(e=>{this.speechError.set(e.message),this.liveTranscript.set(""),setTimeout(()=>this.speechError.set(null),5e3)})}ngOnInit(){this.loadMessagesIfReady(),this.extractUsername(),this.startTypewriterAnimation()}loadMessagesIfReady(){let e=this.localStorageService.getUserId();if(e===null){E.production||console.log("[ChatbotSidebar] userId not set yet, will retry when sidebar opens");return}if(this.loadedForUserId===e){E.production||console.log("[ChatbotSidebar] Messages already loaded for user",e);return}this.speechService.reloadVoices(),E.production||console.log("[ChatbotSidebar] Loading messages for user",e);let t=this.chatbotService.loadMessages();t.length>0?(this.messages.set(t),this.showWelcome.set(!1),E.production||console.log("[ChatbotSidebar] Loaded",t.length,"messages from storage")):(E.production||console.log("[ChatbotSidebar] No saved messages, showing welcome"),this.addWelcomeMessage()),this.localStorageService.getItem("bonzi_autoSpeak")===!0?this.autoSpeak.set(!0):this.autoSpeak.set(!1),this.loadedForUserId=e}ngOnDestroy(){this.speechSubscription&&this.speechSubscription.unsubscribe(),this.errorSubscription&&this.errorSubscription.unsubscribe(),this.stopTypewriterAnimation(),this.stopCommandPlaceholderAnimation(),this.speechService.stopListening(),this.speechService.stopSpeaking()}addWelcomeMessage(){this.showWelcome.set(!1)}isNearBottom(){if(!this.scrollContainer?.nativeElement)return!0;let e=this.scrollContainer.nativeElement;return e.scrollHeight-e.scrollTop-e.clientHeight<100}scrollToBottomSmooth(){setTimeout(()=>{try{this.scrollContainer?.nativeElement&&this.scrollContainer.nativeElement.scrollTo({top:this.scrollContainer.nativeElement.scrollHeight,behavior:"smooth"})}catch{}},50)}toggleSidebar(){this.chatbotService.toggle()}sendMessage(){let e=this.userInput().trim();if(!(!e||this.isLoading())){if(e.length>We.MAX_MESSAGE_LENGTH){this.handleError(`Message is too long. Maximum ${We.MAX_MESSAGE_LENGTH} characters allowed.`);return}this.sendMessageWithText(e)}}sendMessageWithText(e){let t=this.isNearBottom();this.messages.update(o=>[...o,{text:e,isUser:!0,timestamp:new Date}]),this.userInput.set(""),this.resetTextareaHeight(),this.isLoading.set(!0),this.lastError.set(null),this.scrollToBottomSmooth(),this.chatbotService.sendMessage(e).subscribe({next:o=>{if(!o){this.handleError("Sorry, I received an empty response. Please try again.");return}let n=this.parseResponse(o),r={text:n.text,isUser:!1,timestamp:new Date,action:n.action,visualization:n.visualization};this.messages.update(a=>[...a,r]),this.isLoading.set(!1),t&&this.scrollToBottomSmooth(),this.autoSpeak()&&n.text&&this.speakMessage(n.text)},error:o=>{let n="Sorry, I couldn't reach the server. Please try again.";o&&(o.status===429?n=`\u23F1\uFE0F You're sending messages too quickly. Please wait ${o.error?.retryAfterSeconds||60} seconds before trying again.`:typeof o=="string"?n=o:o.error?o.error.output?n=o.error.output:n=typeof o.error=="string"?o.error:o.error.message||n:o.message&&(n=o.message)),this.handleError(n),this.isLoading.set(!1)}})}handleError(e){this.lastError.set(e),this.messages.update(t=>[...t,{text:e,isUser:!1,timestamp:new Date}])}retryLastMessage(){let e=this.messages().filter(t=>t.isUser);if(e.length>0){let t=e[e.length-1];this.sendMessageWithText(t.text)}}sendQuickAction(e){this.userInput.set(e),this.sendMessage()}toggleCommandPalette(){let e=!this.showCommandPalette();this.showCommandPalette.set(e),e&&(this.filteredCommands.set([...this.quickActions]),this.selectedCommandIndex.set(0),setTimeout(()=>{this.textareaRef?.nativeElement.focus()},0))}closeCommandPalette(){this.showCommandPalette.set(!1),this.filteredCommands.set([]),this.selectedCommandIndex.set(0),this.stopCommandPlaceholderAnimation(),this.inputPlaceholder.set("Type a message or / for commands...")}onInputChange(e){if(this.userInput.set(e),e==="/")this.showCommandPalette.set(!0),this.filteredCommands.set([...this.quickActions]),this.selectedCommandIndex.set(0),this.startCommandPlaceholderAnimation();else if(this.showCommandPalette()&&e.startsWith("/")){let t=e.substring(1).toLowerCase(),o=this.quickActions.filter(n=>n.command.substring(1).toLowerCase().includes(t)||n.text.toLowerCase().includes(t));this.filteredCommands.set(o),this.selectedCommandIndex.set(0),o.length>0&&this.inputPlaceholder.set(`Try: ${o[0].command} - ${o[0].text}`)}else this.showCommandPalette()&&!e.startsWith("/")?this.closeCommandPalette():e===""&&(this.stopCommandPlaceholderAnimation(),this.inputPlaceholder.set("Type a message or / for commands..."))}startCommandPlaceholderAnimation(){this.stopCommandPlaceholderAnimation(),this.currentCommandIndex=0,this.updateCommandPlaceholder(),this.commandPlaceholderInterval=window.setInterval(()=>{this.currentCommandIndex=(this.currentCommandIndex+1)%this.quickActions.length,this.updateCommandPlaceholder()},2e3)}stopCommandPlaceholderAnimation(){this.commandPlaceholderInterval!==null&&(clearInterval(this.commandPlaceholderInterval),this.commandPlaceholderInterval=null)}updateCommandPlaceholder(){let e=this.quickActions[this.currentCommandIndex];this.inputPlaceholder.set(`Try: ${e.command} - ${e.text}`)}executeQuickAction(e){this.closeCommandPalette(),this.sendQuickAction(e.prompt)}selectCommand(e,t){this.selectedCommandIndex.set(t),this.executeQuickAction(e)}clearChat(){this.messages.set([]),this.chatbotService.clearHistory(),this.showTypewriter.set(!0),this.startTypewriterAnimation(),this.lastError.set(null)}handleKeydown(e){if(this.showCommandPalette()){if(e.key==="ArrowDown"){e.preventDefault();let t=this.filteredCommands().length-1;this.selectedCommandIndex.set(Math.min(this.selectedCommandIndex()+1,t));return}if(e.key==="ArrowUp"){e.preventDefault(),this.selectedCommandIndex.set(Math.max(this.selectedCommandIndex()-1,0));return}if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();let t=this.filteredCommands()[this.selectedCommandIndex()];t&&this.executeQuickAction(t);return}if(e.key==="Escape"){e.preventDefault(),this.closeCommandPalette();return}}e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),this.sendMessage())}autoResize(e){let t=e.target;if(!t)return;t.style.height="auto";let o=Math.min(t.scrollHeight,150);t.style.height=`${o}px`}resetTextareaHeight(){this.textareaRef?.nativeElement&&(this.textareaRef.nativeElement.style.height="auto")}parseMarkdown(e){let t=v.parse(e),o=kn.sanitize(t);return this.sanitizer.bypassSecurityTrustHtml(o)}parseResponse(e){if(typeof e=="string")return{text:e};let t=e.output||e.text||e.message||e.response||"";!t&&typeof e=="object"&&(e.error?t=e.error:t=JSON.stringify(e));let o=e.action;!o&&typeof t=="string"&&(o=this.extractActionFromText(t),o&&(t=this.removeJsonFromText(t)));let n=e.visualization;return!n&&typeof t=="string"&&(n=this.extractVisualizationFromText(t),n&&(t=this.removeVisualizationFromText(t))),{text:t,action:o,visualization:n}}extractActionFromText(e){let t=/```json\s*(\{[\s\S]*?"action"[\s\S]*?\})\s*```/i,o=e.match(t);if(o)try{let s=JSON.parse(o[1]);if(s.action)return this.normalizeAction(s.action)}catch{}let n=/\[ACTION:(\w+):([^\]]+)\]/i,r=e.match(n);if(r){let[,s,h]=r;if(s.toLowerCase()==="navigate")return{type:"navigate",path:h.split("?")[0],queryParams:this.parseQueryString(h),label:"Go there",icon:"bi-arrow-right-circle"}}let a=/\{[^{}]*"action"\s*:\s*\{[^{}]*\}[^{}]*\}/i,l=e.match(a);if(l)try{let s=JSON.parse(l[0]);if(s.action)return this.normalizeAction(s.action)}catch{}}normalizeAction(e){return{type:e.type||"navigate",path:e.path,queryParams:e.queryParams||e.params,elementId:e.elementId,label:e.label||this.getDefaultLabel(e.type,e.path),icon:e.icon||this.getDefaultIcon(e.type,e.path)}}getDefaultLabel(e,t){return e==="navigate"&&t?t.includes("transaction")?"Add transaction":t.includes("saving")?"Go to savings":t.includes("budget")?"Go to budgets":t.includes("dashboard")?"View dashboard":t.includes("report")?"View reports":"Go there":e==="scroll"?"View section":"Take action"}getDefaultIcon(e,t){return e==="navigate"&&t?t.includes("transaction")?"bi-plus-circle":t.includes("saving")?"bi-piggy-bank":t.includes("budget")?"bi-wallet2":t.includes("dashboard")?"bi-grid":t.includes("report")?"bi-bar-chart":"bi-arrow-right-circle":e==="scroll"?"bi-arrow-down-circle":"bi-lightning"}parseQueryString(e){let t={},o=e.indexOf("?");if(o===-1)return t;let r=e.substring(o+1).split("&");for(let a of r){let[l,s]=a.split("=");if(l&&s){let h=decodeURIComponent(s);if(/date$/i.test(l))t[l]=h;else{let k=parseFloat(h);t[l]=isNaN(k)?h:k}}}return t}removeJsonFromText(e){return e=e.replace(/```json\s*\{[\s\S]*?\}\s*```/gi,""),e=e.replace(/\[ACTION:\w+:[^\]]+\]/gi,""),e=e.replace(/\{[^{}]*"action"\s*:\s*\{[^{}]*\}[^{}]*\}/gi,""),e=e.replace(/\n{3,}/g,`

`).trim(),e}extractVisualizationFromText(e){let t=/```json\s*(\{[\s\S]*?"visualization"[\s\S]*?\})\s*```/i,o=e.match(t);if(o)try{let a=JSON.parse(o[1]);if(a.visualization&&this.isValidVisualization(a.visualization))return a.visualization}catch{}let n=/```json\s*(\{[\s\S]*?"type"\s*:\s*"(?:doughnut|pie|bar|line)"[\s\S]*?\})\s*```/i,r=e.match(n);if(r)try{let a=JSON.parse(r[1]);if(this.isValidVisualization(a))return a}catch{}}isValidVisualization(e){return!(!e||typeof e!="object"||!["doughnut","pie","bar","line"].includes(e.type)||!e.data||!Array.isArray(e.data.labels)||!Array.isArray(e.data.values)||e.data.labels.length===0||e.data.values.length===0)}removeVisualizationFromText(e){return e=e.replace(/```json\s*\{[\s\S]*?"visualization"[\s\S]*?\}\s*```/gi,""),e=e.replace(/```json\s*\{[\s\S]*?"type"\s*:\s*"(?:doughnut|pie|bar|line)"[\s\S]*?\}\s*```/gi,""),e=e.replace(/\n{3,}/g,`

`).trim(),e}executeAction(e){if(e)switch(e.type){case"navigate":e.path&&(this.chatbotService.toggle(),e.queryParams&&Object.keys(e.queryParams).length>0?this.router.navigate([e.path],{queryParams:e.queryParams}):this.router.navigate([e.path]));break;case"scroll":if(e.elementId){let t=document.getElementById(e.elementId);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}break;case"open-modal":e.path&&(this.chatbotService.toggle(),this.router.navigate([e.path],{queryParams:z(y({},e.queryParams),{openModal:"true"})}));break;default:console.warn("Unknown action type:",e.type)}}toggleRecording(){if(!this.isSTTSupported()){this.speechError.set("Speech recognition is not supported in your browser. Try Chrome or Edge."),setTimeout(()=>this.speechError.set(null),5e3);return}this.speechError.set(null),this.isRecording()?(this.speechService.stopListening(),this.liveTranscript.set("")):this.speechService.startListening()}toggleAutoSpeak(){if(!this.isTTSSupported()){this.speechError.set("Text-to-speech is not supported in your browser."),setTimeout(()=>this.speechError.set(null),5e3);return}let e=!this.autoSpeak();this.autoSpeak.set(e),this.localStorageService.setItem("bonzi_autoSpeak",e),!e&&this.isSpeaking()&&this.speechService.stopSpeaking()}speakMessage(e){this.isTTSSupported()&&(this.isSpeaking()?this.speechService.stopSpeaking():this.speechService.speak(e))}stopSpeaking(){this.speechService.stopSpeaking()}async copyMessage(e){try{let t=this.stripMarkdown(e.text);await navigator.clipboard.writeText(t);let o=e.timestamp.getTime();this.copiedMessageId.set(o),setTimeout(()=>{this.copiedMessageId()===o&&this.copiedMessageId.set(null)},2e3)}catch(t){console.error("Failed to copy message:",t),this.fallbackCopyToClipboard(e)}}stripMarkdown(e){return e.replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/__([^_]+)__/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/`([^`]+)`/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/\n{3,}/g,`

`).trim()}fallbackCopyToClipboard(e){let t=document.createElement("textarea");t.value=this.stripMarkdown(e.text),t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy");let o=e.timestamp.getTime();this.copiedMessageId.set(o),setTimeout(()=>{this.copiedMessageId()===o&&this.copiedMessageId.set(null)},2e3)}catch(o){console.error("Fallback copy failed:",o)}document.body.removeChild(t)}toggleSettings(){this.showSettings.update(e=>!e)}selectVoice(e){this.speechService.setVoiceByName(e)}previewVoice(){this.speechService.speak("Hello! This is how I will read messages. The price is \u20B11,500 pesos.")}getGroupedVoices(){let e=this.availableVoices(),t=new Map;e.forEach(r=>{let a=r.lang;t.has(a)||t.set(a,[]),t.get(a).push(r)});let o=[];return["en-PH","fil-PH","en-US","en-GB","en-AU"].forEach(r=>{t.has(r)&&(o.push({lang:r,langName:this.getLanguageName(r),voices:t.get(r)}),t.delete(r))}),Array.from(t.entries()).sort((r,a)=>r[0].localeCompare(a[0])).forEach(([r,a])=>{o.push({lang:r,langName:this.getLanguageName(r),voices:a})}),o}getLanguageName(e){return{"en-PH":"\u{1F1F5}\u{1F1ED} English (Philippines)","fil-PH":"\u{1F1F5}\u{1F1ED} Filipino","en-US":"\u{1F1FA}\u{1F1F8} English (US)","en-GB":"\u{1F1EC}\u{1F1E7} English (UK)","en-AU":"\u{1F1E6}\u{1F1FA} English (Australia)","en-IN":"\u{1F1EE}\u{1F1F3} English (India)","en-CA":"\u{1F1E8}\u{1F1E6} English (Canada)","es-ES":"\u{1F1EA}\u{1F1F8} Spanish (Spain)","es-MX":"\u{1F1F2}\u{1F1FD} Spanish (Mexico)","fr-FR":"\u{1F1EB}\u{1F1F7} French","de-DE":"\u{1F1E9}\u{1F1EA} German","it-IT":"\u{1F1EE}\u{1F1F9} Italian","ja-JP":"\u{1F1EF}\u{1F1F5} Japanese","ko-KR":"\u{1F1F0}\u{1F1F7} Korean","zh-CN":"\u{1F1E8}\u{1F1F3} Chinese (Simplified)","zh-TW":"\u{1F1F9}\u{1F1FC} Chinese (Traditional)","pt-BR":"\u{1F1E7}\u{1F1F7} Portuguese (Brazil)","ru-RU":"\u{1F1F7}\u{1F1FA} Russian"}[e]||e}extractUsername(){try{let e=localStorage.getItem("iBudget_username");if(e){this.userName.set(e);return}let t=localStorage.getItem("iBudget_authToken");if(!t){this.userName.set("Guest");return}let o=JSON.parse(atob(t.split(".")[1])),n=o.username||o.name||"Guest";this.userName.set(n)}catch(e){console.error("Error extracting username:",e),this.userName.set("Guest")}}startTypewriterAnimation(){let e=`Hi, ${this.userName()}`,t=0,o=!1;this.typewriterText.set("");let n=()=>{o?t>0?(t--,this.typewriterText.set(e.substring(0,t)),this.typewriterTimeoutId=window.setTimeout(n,50)):this.typewriterTimeoutId=window.setTimeout(()=>{o=!1,n()},500):t<e.length?(this.typewriterText.set(e.substring(0,t+1)),t++,this.typewriterTimeoutId=window.setTimeout(n,80)):this.typewriterTimeoutId=window.setTimeout(()=>{o=!0,n()},2e3)};n()}stopTypewriterAnimation(){this.typewriterTimeoutId!==null&&(clearTimeout(this.typewriterTimeoutId),this.typewriterTimeoutId=null)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=H({type:i,selectors:[["app-chatbot-sidebar"]],viewQuery:function(t,o){if(t&1&&(Ue(Zi,5),Ue(Ki,5)),t&2){let n;He(n=Ge())&&(o.scrollContainer=n.first),He(n=Ge())&&(o.textareaRef=n.first)}},decls:35,vars:21,consts:[["scrollContainer",""],["textareaRef",""],[1,"chatbot-sidebar"],[1,"chatbot-header"],[1,"header-content"],["src","assets/images/kamen-rider-gotchard.jpg","alt","Bonzi",1,"header-avatar"],[1,"header-actions"],["title","Clear chat history",1,"icon-btn",3,"click"],[1,"bi","bi-trash"],[1,"close-btn",3,"click"],[1,"bi","bi-x-lg"],[1,"settings-panel"],[1,"messages-container"],[1,"empty-state"],[1,"message-wrapper",3,"user","bot"],[1,"typing-indicator"],[1,"error-actions"],[1,"input-area"],[1,"speech-error"],[1,"live-transcript"],[1,"command-palette"],[1,"quick-pills"],[1,"input-container"],[1,"textarea-wrapper"],["rows","1","maxlength","1000",3,"ngModelChange","keydown","input","ngModel","placeholder"],[1,"input-actions"],[1,"action-icon-btn","slash-btn",3,"click","title","disabled"],[1,"bi","bi-lightning-charge"],[1,"action-icon-btn","mic-btn",3,"recording","title","disabled"],[1,"action-icon-btn","send-btn",3,"click","disabled"],[1,"bi","bi-arrow-up"],["title","Voice settings",1,"icon-btn",3,"click"],[1,"bi","bi-gear"],[1,"icon-btn",3,"click","title"],[1,"bi",3,"ngClass"],[1,"settings-header"],[1,"bi","bi-volume-up"],[1,"settings-content"],[1,"settings-label"],[1,"voice-select",3,"ngModelChange","ngModel"],[3,"label"],[1,"preview-btn",3,"click","disabled"],[1,"settings-hint"],[1,"bi","bi-info-circle"],[3,"value"],[1,"greeting-icon"],["src","assets/images/kamen-rider-gotchard.jpg","alt","Bonzi Buddy"],[1,"typewriter-greeting"],[1,"cursor"],[1,"greeting-subtitle"],[1,"greeting-hint"],[1,"message-wrapper"],[1,"bot-avatar"],[1,"message"],[1,"message-content",3,"innerHTML"],[3,"visualization"],[1,"message-action"],[1,"message-footer"],[1,"message-time"],[1,"footer-actions"],["src","assets/images/kamen-rider-gotchard.jpg","alt","Bonzi"],[1,"action-btn",3,"click"],[1,"bi","bi-chevron-right","action-arrow"],[1,"copy-btn",3,"click","title"],[1,"speak-btn",3,"title"],[1,"speak-btn",3,"click","title"],[1,"typing-avatar"],[1,"typing-bubble"],[1,"typing-dots"],[1,"dot"],[1,"typing-text"],[1,"retry-btn",3,"click"],[1,"bi","bi-arrow-clockwise"],[1,"bi","bi-exclamation-circle"],[1,"bi","bi-mic-fill","recording-icon"],[1,"command-palette-header"],[1,"close-palette-btn",3,"click"],[1,"bi","bi-x"],[1,"command-palette-list"],[1,"command-item",3,"selected"],[1,"command-empty"],[1,"command-item",3,"click","mouseenter"],[1,"bi"],[1,"command-text"],[1,"command-name"],[1,"command-desc"],[1,"command-kbd"],[1,"bi","bi-search"],[1,"quick-pill"],[1,"quick-pill",3,"click"],[1,"action-icon-btn","mic-btn",3,"click","title","disabled"]],template:function(t,o){if(t&1){let n=A();c(0,"div",2)(1,"div",3)(2,"div",4),m(3,"img",5),c(4,"h3"),f(5,"Bonzi Buddy Chat"),d()(),c(6,"div",6),S(7,to,4,6),c(8,"button",7),O("click",function(){return P(n),M(o.clearChat())}),m(9,"i",8),d(),c(10,"button",9),O("click",function(){return P(n),M(o.toggleSidebar())}),m(11,"i",10),d()()(),S(12,oo,17,4,"div",11),c(13,"div",12,0),S(15,ro,13,1,"div",13),Q(16,go,11,17,"div",14,Xi),S(18,ho,10,1,"div",15),S(19,uo,4,0,"div",16),d(),c(20,"div",17),S(21,mo,4,1,"div",18),S(22,fo,4,1,"div",19),S(23,_o,11,1,"div",20),S(24,ko,3,0,"div",21),c(25,"div",22)(26,"div",23)(27,"textarea",24,1),O("ngModelChange",function(a){return P(n),M(o.onInputChange(a))})("keydown",function(a){return P(n),M(o.handleKeydown(a))})("input",function(a){return P(n),M(o.autoResize(a))}),d()(),c(29,"div",25)(30,"button",26),O("click",function(){return P(n),M(o.toggleCommandPalette())}),m(31,"i",27),d(),S(32,vo,2,5,"button",28),c(33,"button",29),O("click",function(){return P(n),M(o.sendMessage())}),m(34,"i",30),d()()()()()}t&2&&(L("open",o.isOpen()),p(7),T(o.isTTSSupported()?7:-1),p(5),T(o.showSettings()?12:-1),p(3),T(o.messages().length===0&&o.showTypewriter()?15:-1),p(),Z(o.messages()),p(2),T(o.isLoading()?18:-1),p(),T(o.lastError()?19:-1),p(2),T(o.speechError()?21:-1),p(),T(o.isRecording()&&o.liveTranscript()?22:-1),p(),T(o.showCommandPalette()&&o.filteredCommands().length>0?23:-1),p(),T(o.showCommandPalette()?24:-1),p(3),w("ngModel",o.userInput())("placeholder",o.isRecording()?"Listening... Click mic to stop":o.inputPlaceholder()),p(3),L("active",o.showCommandPalette()),w("title",o.showCommandPalette()?"Close commands":"Quick commands")("disabled",o.isLoading()),p(2),T(o.isSTTSupported()?32:-1),p(),L("active",o.userInput().trim()&&!o.isLoading()),w("disabled",!o.userInput().trim()||o.isLoading()))},dependencies:[X,Ce,fn,hn,un,ln,gn,pn,mn,dn,Oe,Ut],styles:['.chatbot-toggle[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;padding:12px 24px;background-color:#3498db;border-radius:50px;display:flex;align-items:center;justify-content:center;gap:10px;cursor:pointer;box-shadow:0 4px 12px #0003;z-index:1000;transition:transform .3s cubic-bezier(.175,.885,.32,1.275)}.chatbot-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:20px}.chatbot-toggle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-weight:600;font-size:16px;white-space:nowrap}.chatbot-toggle[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.chatbot-toggle.hidden[_ngcontent-%COMP%]{transform:scale(0);pointer-events:none}.chatbot-sidebar[_ngcontent-%COMP%]{position:fixed;top:70px;right:-400px;width:400px;height:calc(100vh - 70px);background-color:#fff;box-shadow:-5px 0 15px #0000001a;z-index:1001;transition:right .3s ease-in-out;display:flex;flex-direction:column;border-left:1px solid #e5e7eb;font-family:Inter,sans-serif}.chatbot-sidebar.open[_ngcontent-%COMP%]{right:0}@media (min-width: 376px) and (max-width: 425px){.chatbot-sidebar[_ngcontent-%COMP%]{top:65px;height:calc(100vh - 65px)}.chatbot-sidebar.open[_ngcontent-%COMP%]{right:0}}@media (max-width: 375px){.chatbot-sidebar[_ngcontent-%COMP%]{top:60px;height:100%}.chatbot-sidebar.open[_ngcontent-%COMP%]{right:0;top:0}}@media (max-width: 480px){.chatbot-sidebar[_ngcontent-%COMP%]{width:100%;right:-100%;height:100%}.chatbot-sidebar.open[_ngcontent-%COMP%]{right:0;top:0}}@media (min-width: 481px) and (max-width: 768px){.chatbot-sidebar[_ngcontent-%COMP%]{height:88%;top:60px}}.chatbot-header[_ngcontent-%COMP%]{padding:20px;background:#fff;border-bottom:1px solid rgba(0,0,0,.06);display:flex;justify-content:space-between;align-items:center;color:#2c3e50}.chatbot-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.chatbot-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid #3498db;box-shadow:0 2px 6px #3498db4d}.chatbot-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem;color:#3498db}.chatbot-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600}.chatbot-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.chatbot-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{background:none;border:none;color:#9ca3af;cursor:pointer;font-size:1rem;padding:6px;border-radius:4px;transition:all .2s;display:flex;align-items:center;justify-content:center}.chatbot-header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:hover{color:#2c3e50;background-color:#f3f4f6}.chatbot-header[_ngcontent-%COMP%]   .icon-btn.active[_ngcontent-%COMP%]{color:#3498db;background-color:#3498db1a}.chatbot-header[_ngcontent-%COMP%]   .icon-btn.active[_ngcontent-%COMP%]:hover{background-color:#3498db26}.chatbot-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#9ca3af;cursor:pointer;font-size:1.2rem;transition:color .2s}.chatbot-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{color:#2c3e50}.settings-panel[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e5e7eb;padding:15px 20px;animation:_ngcontent-%COMP%_slideDown .2s ease}.settings-panel[_ngcontent-%COMP%]   .settings-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:600;color:#2c3e50;margin-bottom:12px;font-size:.9rem}.settings-panel[_ngcontent-%COMP%]   .settings-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#3498db}.settings-panel[_ngcontent-%COMP%]   .settings-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.settings-panel[_ngcontent-%COMP%]   .settings-label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:500;color:#6b7280;text-transform:uppercase;letter-spacing:.5px}.settings-panel[_ngcontent-%COMP%]   .voice-select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;background-color:#fff;color:#2c3e50;font-size:.9rem;cursor:pointer;outline:none;transition:border-color .2s,box-shadow .2s}.settings-panel[_ngcontent-%COMP%]   .voice-select[_ngcontent-%COMP%]:focus{border-color:#3498db;box-shadow:0 0 0 2px #3498db1a}.settings-panel[_ngcontent-%COMP%]   .voice-select[_ngcontent-%COMP%]   optgroup[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.settings-panel[_ngcontent-%COMP%]   .voice-select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{padding:8px}.settings-panel[_ngcontent-%COMP%]   .preview-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;background-color:#3498db;color:#fff;border:none;border-radius:8px;font-size:.9rem;font-weight:500;cursor:pointer;transition:background-color .2s,opacity .2s}.settings-panel[_ngcontent-%COMP%]   .preview-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#258cd1}.settings-panel[_ngcontent-%COMP%]   .preview-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.settings-panel[_ngcontent-%COMP%]   .preview-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.settings-panel[_ngcontent-%COMP%]   .settings-hint[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:6px;font-size:.8rem;color:#6b7280;margin:0;padding:8px 10px;background-color:#3498db0d;border-radius:6px;line-height:1.4}.settings-panel[_ngcontent-%COMP%]   .settings-hint[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{flex-shrink:0;margin-top:2px;color:#3498db}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.messages-container[_ngcontent-%COMP%]{flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:15px;background-color:transparent}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:60px 40px;text-align:center}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .greeting-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin-bottom:32px}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .greeting-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:16px;object-fit:cover;box-shadow:0 8px 24px #3498db33}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .typewriter-greeting[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;color:#2c3e50;margin:0 0 16px;font-family:Inter,sans-serif}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .typewriter-greeting[_ngcontent-%COMP%]   .cursor[_ngcontent-%COMP%]{display:inline-block;margin-left:4px;animation:_ngcontent-%COMP%_blink 1s step-end infinite;color:#3498db}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .greeting-subtitle[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500;color:#2c3e50;margin:0 0 12px}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .greeting-hint[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;margin:0;line-height:1.6;max-width:320px}@media (max-width: 480px){.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:40px 20px}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .greeting-icon[_ngcontent-%COMP%]{width:64px;height:64px;margin-bottom:24px}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .typewriter-greeting[_ngcontent-%COMP%]{font-size:1.5rem}.messages-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .greeting-subtitle[_ngcontent-%COMP%]{font-size:1rem}}@keyframes _ngcontent-%COMP%_blink{0%,50%{opacity:1}51%,to{opacity:0}}.message-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:8px;width:100%}.message-wrapper.user[_ngcontent-%COMP%]{flex-direction:row-reverse;justify-content:flex-start}.message-wrapper.bot[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start}.bot-avatar[_ngcontent-%COMP%]{width:32px;height:32px;flex-shrink:0;align-self:flex-end;margin-bottom:3px}.bot-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover;border:2px solid #3498db;box-shadow:0 2px 6px #3498db33}.message[_ngcontent-%COMP%]{max-width:85%;padding:12px 16px;border-radius:12px;font-size:.95rem;line-height:1.5;position:relative;animation:_ngcontent-%COMP%_fadeIn .3s ease;box-shadow:0 1px 2px #0000000d}.message.user[_ngcontent-%COMP%]{align-self:flex-end;background:linear-gradient(135deg,#3498db,#2980b9);color:#fff;border-bottom-right-radius:2px;box-shadow:0 4px 12px #3498db40}.message.user[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{color:#fffc}.message.bot[_ngcontent-%COMP%]{align-self:flex-start;background-color:#f1f0f0;color:#2c3e50;border-bottom-left-radius:2px;border:1px solid #e5e7eb}.message.bot[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%], .message.bot[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .speak-btn[_ngcontent-%COMP%], .message.bot[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]{color:#9ca3af}.message.bot[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .speak-btn[_ngcontent-%COMP%]:hover, .message.bot[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]:hover{color:#3498db}.message.bot[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .copy-btn.copied[_ngcontent-%COMP%]{color:#2ecc71}.message[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-top:5px;gap:8px}.message[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .footer-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.message[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{font-size:.7rem;text-align:right;display:block}.message[_ngcontent-%COMP%]   .speak-btn[_ngcontent-%COMP%]{background:none;border:none;padding:2px 4px;cursor:pointer;font-size:.8rem;opacity:.7;transition:all .2s;border-radius:4px}.message[_ngcontent-%COMP%]   .speak-btn[_ngcontent-%COMP%]:hover{opacity:1;background-color:#0000000d}.message[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]{background:none;border:none;padding:2px 4px;cursor:pointer;font-size:.8rem;opacity:.7;transition:all .2s;border-radius:4px;position:relative}.message[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]:hover{opacity:1;background-color:#0000000d}.message[_ngcontent-%COMP%]   .copy-btn.copied[_ngcontent-%COMP%]{color:#2ecc71;opacity:1}.typing-indicator[_ngcontent-%COMP%]{align-self:flex-start;display:flex;align-items:flex-end;gap:10px;padding:5px 0;animation:_ngcontent-%COMP%_fadeIn .3s ease}.typing-indicator[_ngcontent-%COMP%]   .typing-avatar[_ngcontent-%COMP%]{width:36px;height:36px;background:transparent;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden;border:2px solid #3498db;animation:_ngcontent-%COMP%_avatarPulse 2s ease-in-out infinite}.typing-indicator[_ngcontent-%COMP%]   .typing-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.typing-indicator[_ngcontent-%COMP%]   .typing-avatar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:1.1rem}.typing-indicator[_ngcontent-%COMP%]   .typing-bubble[_ngcontent-%COMP%]{background-color:#f1f0f0;border:1px solid #e5e7eb;border-radius:12px 12px 12px 2px;padding:12px 16px;display:flex;flex-direction:column;gap:6px;box-shadow:0 1px 2px #0000000d}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center;height:20px}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:8px;height:8px;background-color:#3498db;border-radius:50%;animation:_ngcontent-%COMP%_typingBounce 1.4s infinite ease-in-out both}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:nth-child(1){animation-delay:0s}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:nth-child(2){animation-delay:.16s}.typing-indicator[_ngcontent-%COMP%]   .typing-dots[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:nth-child(3){animation-delay:.32s}.typing-indicator[_ngcontent-%COMP%]   .typing-text[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;font-style:italic}@keyframes _ngcontent-%COMP%_typingBounce{0%,80%,to{transform:scale(.6);opacity:.4}40%{transform:scale(1);opacity:1}}@keyframes _ngcontent-%COMP%_avatarPulse{0%,to{box-shadow:0 0 #3498db66}50%{box-shadow:0 0 0 8px #3498db00}}.input-area[_ngcontent-%COMP%]{margin:16px;padding:0;display:flex;flex-direction:column;gap:8px;background:transparent}.input-area[_ngcontent-%COMP%]   .speech-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background-color:#fef2f2;border:1px solid #fecaca;border-radius:8px;color:#dc2626;font-size:.85rem;animation:_ngcontent-%COMP%_fadeIn .3s ease}.input-area[_ngcontent-%COMP%]   .speech-error[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{flex-shrink:0}.input-area[_ngcontent-%COMP%]   .live-transcript[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background-color:#3498db1a;border:1px solid rgba(52,152,219,.2);border-radius:20px;color:#2c3e50;font-size:.9rem;font-style:italic;animation:_ngcontent-%COMP%_fadeIn .3s ease}.input-area[_ngcontent-%COMP%]   .live-transcript[_ngcontent-%COMP%]   .recording-icon[_ngcontent-%COMP%]{color:#dc2626;animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:26px;padding:12px 16px 8px;transition:border-color .2s,box-shadow .2s;box-shadow:0 2px 8px #00000014,0 1px 2px #0000000a;display:flex;flex-direction:column;gap:4px}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:focus-within{border-color:#3498db;box-shadow:0 4px 12px #0000001f,0 0 0 3px #3498db1a}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .textarea-wrapper[_ngcontent-%COMP%]{width:100%;display:flex}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex:1;width:100%;background:transparent;border:none;padding:0;color:#2c3e50;resize:none;min-height:24px;max-height:150px;font-family:inherit;font-size:.95rem;line-height:1.5;outline:none;overflow-y:auto}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder{color:#9ca3af;transition:opacity .3s ease,color .3s ease;animation:_ngcontent-%COMP%_placeholderFade .5s ease-in-out}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:2px}@keyframes _ngcontent-%COMP%_placeholderFade{0%{opacity:0;transform:translateY(-2px)}to{opacity:1;transform:translateY(0)}}.input-area[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .input-actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:6px}.input-area[_ngcontent-%COMP%]   .action-icon-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;font-size:1rem}.input-area[_ngcontent-%COMP%]   .action-icon-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.input-area[_ngcontent-%COMP%]   .mic-btn[_ngcontent-%COMP%]{background:transparent;color:#6b7280}.input-area[_ngcontent-%COMP%]   .mic-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6;color:#3498db}.input-area[_ngcontent-%COMP%]   .mic-btn.recording[_ngcontent-%COMP%]{background:#dc2626;color:#fff;animation:_ngcontent-%COMP%_recordingPulse 1.5s ease-in-out infinite}.input-area[_ngcontent-%COMP%]   .mic-btn.recording[_ngcontent-%COMP%]:hover{background:#b91c1c}.input-area[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]{background:#e5e7eb;color:#9ca3af}.input-area[_ngcontent-%COMP%]   .send-btn.active[_ngcontent-%COMP%]{background:#3498db;color:#fff}.input-area[_ngcontent-%COMP%]   .send-btn.active[_ngcontent-%COMP%]:hover{background:#258cd1;transform:scale(1.05)}.input-area[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]:disabled{background:#e5e7eb;color:#9ca3af}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes _ngcontent-%COMP%_recordingPulse{0%,to{box-shadow:0 0 #dc262666}50%{box-shadow:0 0 0 8px #dc262600}}.message-content[_ngcontent-%COMP%]{word-wrap:break-word;overflow-wrap:break-word;max-width:100%}.message-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .message-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .message-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .message-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .message-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .message-content[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:5px;font-weight:600;line-height:1.2;word-wrap:break-word;overflow-wrap:break-word}.message-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5em}.message-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3em}.message-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1em}.message-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px}.message-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.message-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .message-content[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:8px}.message-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px}.message-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.message-content[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.message-content[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#0000001a;padding:2px 4px;border-radius:4px;font-family:Consolas,Monaco,Courier New,monospace;font-size:.85em}.message-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background-color:#1e1e1e;color:#d4d4d4;padding:12px;border-radius:8px;overflow-x:auto;margin:8px 0;font-size:.85em;line-height:1.4;max-width:100%;white-space:pre-wrap;word-wrap:break-word}.message-content[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:transparent;padding:0;color:inherit;font-size:inherit;white-space:pre-wrap;word-wrap:break-word}.message-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{border-left:4px solid #3498db;background-color:#3498db0d;padding:10px 15px;margin:8px 0;border-radius:0 8px 8px 0;font-style:italic}.message-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.message-content[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;max-width:100%;border-collapse:collapse;margin:10px 0;font-size:.9em;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a;display:block;overflow-x:auto;-webkit-overflow-scrolling:touch}.message-content[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#3498db;color:#fff}.message-content[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px 12px;text-align:left;font-weight:600}.message-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb}.message-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#00000005}.message-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.message-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#3498db0d}.message-content[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px}.message-content[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:none;border-top:1px solid #e5e7eb;margin:15px 0}.message-content[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;margin-right:8px;accent-color:#3498db;vertical-align:middle}.message-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3498db;text-decoration:none}.message-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.quick-actions[_ngcontent-%COMP%]{margin-top:20px;padding:15px;background-color:#fff;border-radius:12px;border:1px solid #e5e7eb}.quick-actions[_ngcontent-%COMP%]   .quick-actions-title[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#6b7280;margin-bottom:12px;text-transform:uppercase;letter-spacing:.5px}.quick-actions[_ngcontent-%COMP%]   .quick-actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:8px}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e5e7eb;border-radius:8px;padding:12px;cursor:pointer;transition:all .25s ease;display:flex;flex-direction:column;align-items:center;gap:6px;text-align:center;font-size:.85rem;color:#2c3e50}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem;color:#3498db;transition:color .25s ease}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;line-height:1.2}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:hover{color:#fff;border-color:transparent;transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#fff}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:nth-child(1):hover{background:linear-gradient(135deg,#13547a,#80d0c7)}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:nth-child(2):hover{background:linear-gradient(135deg,#f6d365,#fda085);color:#2c3e50}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:nth-child(2):hover   i[_ngcontent-%COMP%]{color:#2c3e50}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:nth-child(3):hover{background:linear-gradient(135deg,#dfffcd,#39f3bb);color:#2c3e50}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:nth-child(3):hover   i[_ngcontent-%COMP%]{color:#2c3e50}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:nth-child(4):hover{background:linear-gradient(135deg,#b6cee8,#f578dc)}.quick-actions[_ngcontent-%COMP%]   .quick-action-chip[_ngcontent-%COMP%]:active{transform:translateY(0)}.error-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:10px 0}.error-actions[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;border-radius:8px;padding:10px 20px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:.9rem;font-weight:500;transition:all .2s;box-shadow:0 2px 4px #0000001a}.error-actions[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.error-actions[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:hover{background-color:#258cd1;transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.error-actions[_ngcontent-%COMP%]   .retry-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.message-action[_ngcontent-%COMP%]{margin-top:12px;padding-top:10px;border-top:1px solid rgba(0,0,0,.08)}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;gap:10px;padding:12px 16px;background:linear-gradient(135deg,#3498db,#2383c4);color:#fff;border:none;border-radius:10px;cursor:pointer;font-size:.9rem;font-weight:600;transition:all .25s ease;box-shadow:0 3px 8px #3498db4d;position:relative;overflow:hidden;animation:_ngcontent-%COMP%_actionPulse 2s ease-in-out infinite}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]:first-child{font-size:1.1rem;flex-shrink:0}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:left}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .action-arrow[_ngcontent-%COMP%]{font-size:.85rem;opacity:.8;transition:transform .2s ease}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s ease}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 16px #3498db66}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover   .action-arrow[_ngcontent-%COMP%]{transform:translate(3px)}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:hover:before{left:100%}.message-action[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 6px #3498db4d}@keyframes _ngcontent-%COMP%_actionPulse{0%,to{box-shadow:0 3px 8px #3498db4d}50%{box-shadow:0 3px 12px #3498db80}}.message.bot[_ngcontent-%COMP%]   app-chat-chart[_ngcontent-%COMP%]{display:block;margin-top:10px}.message.bot[_ngcontent-%COMP%]   app-chat-chart[_ngcontent-%COMP%]     .chat-chart-container{background:#fffffff2;box-shadow:0 2px 8px #0000000f;border:1px solid rgba(229,231,235,.8)}.message.bot[_ngcontent-%COMP%]   app-chat-chart[_ngcontent-%COMP%]     .chat-chart-container .chart-title{color:#2c3e50;font-size:.85rem}.message.bot[_ngcontent-%COMP%]   app-chat-chart[_ngcontent-%COMP%]     .chat-chart-container .chart-wrapper{height:180px}@media (max-width: 480px){.message.bot[_ngcontent-%COMP%]   app-chat-chart[_ngcontent-%COMP%]     .chat-chart-container .chart-wrapper{height:160px}}.message.bot[_ngcontent-%COMP%]:has(app-chat-chart)   .message-action[_ngcontent-%COMP%]{margin-top:10px}.command-palette[_ngcontent-%COMP%]{position:absolute;bottom:100%;left:0;right:0;margin-bottom:8px;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 8px 24px #00000026;overflow:hidden;z-index:10;animation:_ngcontent-%COMP%_slideUpFade .2s ease-out}.command-palette[_ngcontent-%COMP%]   .command-palette-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,#3498db,#2980b9);color:#fff;font-size:.85rem;font-weight:600}.command-palette[_ngcontent-%COMP%]   .command-palette-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.command-palette[_ngcontent-%COMP%]   .command-palette-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.command-palette[_ngcontent-%COMP%]   .command-palette-header[_ngcontent-%COMP%]   .close-palette-btn[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;padding:2px 4px;border-radius:4px;display:flex;align-items:center;transition:background .2s}.command-palette[_ngcontent-%COMP%]   .command-palette-header[_ngcontent-%COMP%]   .close-palette-btn[_ngcontent-%COMP%]:hover{background:#ffffff26}.command-palette[_ngcontent-%COMP%]   .command-palette-header[_ngcontent-%COMP%]   .close-palette-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.command-palette[_ngcontent-%COMP%]   .command-palette-list[_ngcontent-%COMP%]{max-height:240px;overflow-y:auto;padding:4px}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:12px;padding:10px 12px;background:transparent;border:none;border-radius:8px;cursor:pointer;transition:all .15s ease;text-align:left}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem;color:#3498db;flex-shrink:0;transition:transform .15s ease}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]   .command-text[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:2px;min-width:0}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]   .command-text[_ngcontent-%COMP%]   .command-name[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#3498db;font-family:Courier New,monospace}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]   .command-text[_ngcontent-%COMP%]   .command-desc[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]   .command-kbd[_ngcontent-%COMP%]{padding:2px 6px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:4px;font-size:.7rem;color:#6b7280;font-weight:600;flex-shrink:0}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]:hover, .command-palette[_ngcontent-%COMP%]   .command-item.selected[_ngcontent-%COMP%]{background:#3498db14}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%], .command-palette[_ngcontent-%COMP%]   .command-item.selected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.1)}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]:hover   .command-kbd[_ngcontent-%COMP%], .command-palette[_ngcontent-%COMP%]   .command-item.selected[_ngcontent-%COMP%]   .command-kbd[_ngcontent-%COMP%]{background:#3498db;color:#fff;border-color:#3498db}.command-palette[_ngcontent-%COMP%]   .command-item[_ngcontent-%COMP%]:active{transform:scale(.98)}.command-palette[_ngcontent-%COMP%]   .command-empty[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:24px;color:#9ca3af;font-size:.85rem}.command-palette[_ngcontent-%COMP%]   .command-empty[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}@keyframes _ngcontent-%COMP%_slideUpFade{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.quick-pills[_ngcontent-%COMP%]{display:flex;gap:6px;padding:8px 12px;background:transparent;overflow-x:auto;scrollbar-width:thin;scrollbar-color:#d1d5db transparent}.quick-pills[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px}.quick-pills[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.quick-pills[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:2px}.quick-pills[_ngcontent-%COMP%]   .quick-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#fff;border:1px solid #e5e7eb;border-radius:20px;font-size:.75rem;color:#2c3e50;font-weight:500;cursor:pointer;transition:all .2s ease;white-space:nowrap;flex-shrink:0}.quick-pills[_ngcontent-%COMP%]   .quick-pill[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem;color:#3498db;transition:transform .2s ease}.quick-pills[_ngcontent-%COMP%]   .quick-pill[_ngcontent-%COMP%]:hover{background:#3498db;color:#fff;border-color:#3498db;transform:translateY(-2px);box-shadow:0 2px 8px #3498db4d}.quick-pills[_ngcontent-%COMP%]   .quick-pill[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#fff;transform:scale(1.1)}.quick-pills[_ngcontent-%COMP%]   .quick-pill[_ngcontent-%COMP%]:active{transform:translateY(0)}.input-actions[_ngcontent-%COMP%]   .slash-btn[_ngcontent-%COMP%]{color:#3498db;transition:all .2s ease}.input-actions[_ngcontent-%COMP%]   .slash-btn[_ngcontent-%COMP%]:hover{background:#3498db1a;transform:scale(1.05)}.input-actions[_ngcontent-%COMP%]   .slash-btn.active[_ngcontent-%COMP%]{background:#3498db;color:#fff;box-shadow:0 2px 8px #3498db4d}.input-actions[_ngcontent-%COMP%]   .slash-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}']})};var Po=(i,e)=>e.id;function Mo(i,e){if(i&1){let t=A();c(0,"button",9),O("click",function(){P(t);let n=u().$implicit,r=u();return M(r.handleAction(n))}),f(1),d()}if(i&2){let t=u().$implicit;p(),ne(" ",t.action.label," ")}}function wo(i,e){if(i&1){let t=A();c(0,"div",1),m(1,"i",2),c(2,"div",3)(3,"strong",4),f(4),d(),c(5,"p",5),f(6),d()(),S(7,Mo,2,1,"button",6),c(8,"button",7),O("click",function(){let n=P(t).$implicit,r=u();return M(r.toastService.dismiss(n.id))}),m(9,"i",8),d()()}if(i&2){let t=e.$implicit;w("ngClass",t.type)("@slideIn",void 0),p(),w("ngClass",t.icon),p(3),D(t.title),p(2),D(t.message),p(),T(t.action?7:-1)}}var De=class i{toastService=x(bn);handleAction(e){e.action&&(e.action.callback(),this.toastService.dismiss(e.id))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=H({type:i,selectors:[["app-toast-container"]],decls:4,vars:2,consts:[[1,"toast-container"],[1,"toast",3,"ngClass"],[3,"ngClass"],[1,"toast-content"],[1,"toast-title"],[1,"toast-message"],[1,"toast-action"],["title","Dismiss",1,"toast-dismiss",3,"click"],[1,"fas","fa-times"],[1,"toast-action",3,"click"]],template:function(t,o){t&1&&(c(0,"div",0),Q(1,wo,10,6,"div",1,Po),ie(3,"async"),d()),t&2&&(p(),Z(_e(3,0,o.toastService.toasts$)))},dependencies:[X,Ce,ke],styles:[".toast-container[_ngcontent-%COMP%]{position:fixed;bottom:1rem;right:1rem;z-index:9999;display:flex;flex-direction:column-reverse;gap:.5rem;max-width:400px;pointer-events:none}.toast-container[_ngcontent-%COMP%]   .toast[_ngcontent-%COMP%]{pointer-events:auto}.toast[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;padding:1rem;background:#fff;border-radius:8px;box-shadow:0 4px 12px #00000026;animation:_ngcontent-%COMP%_slideIn .3s ease;border-left:4px solid #3498db}.toast[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:1.25rem;margin-top:.125rem;flex-shrink:0}.toast.info[_ngcontent-%COMP%]{border-left-color:#3498db}.toast.info[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{color:#3498db}.toast.success[_ngcontent-%COMP%]{border-left-color:#27ae60}.toast.success[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{color:#27ae60}.toast.warning[_ngcontent-%COMP%]{border-left-color:#f39c12}.toast.warning[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{color:#f39c12}.toast.error[_ngcontent-%COMP%]{border-left-color:#e74c3c}.toast.error[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{color:#e74c3c}.toast-content[_ngcontent-%COMP%]{flex:1;min-width:0}.toast-title[_ngcontent-%COMP%]{display:block;font-weight:600;color:#2c3e50;margin-bottom:.25rem;word-wrap:break-word}.toast-message[_ngcontent-%COMP%]{font-size:.875rem;color:#7f8c8d;margin:0;line-height:1.4;word-wrap:break-word}.toast-action[_ngcontent-%COMP%]{padding:.35rem .75rem;background:#3498db;color:#fff;border:none;border-radius:4px;font-size:.8rem;font-weight:500;cursor:pointer;flex-shrink:0;transition:background .2s ease}.toast-action[_ngcontent-%COMP%]:hover{background:#2980b9}.toast-dismiss[_ngcontent-%COMP%]{background:transparent;border:none;color:#bdc3c7;cursor:pointer;padding:.25rem;flex-shrink:0;transition:color .2s ease}.toast-dismiss[_ngcontent-%COMP%]:hover{color:#7f8c8d}.toast-dismiss[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@media (max-width: 480px){.toast-container[_ngcontent-%COMP%]{left:.5rem;right:.5rem;max-width:none}.toast[_ngcontent-%COMP%]{padding:.75rem;gap:.5rem}.toast[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:1rem}.toast-title[_ngcontent-%COMP%]{font-size:.9rem}.toast-message[_ngcontent-%COMP%]{font-size:.8rem}.toast-action[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}}"],data:{animation:[Qe("slideIn",[ye(":enter",[se({transform:"translateX(100%)",opacity:0}),we("300ms ease-out",se({transform:"translateX(0)",opacity:1}))]),ye(":leave",[we("200ms ease-in",se({transform:"translateX(100%)",opacity:0}))])])]}})};var Ve=class i{swUpdate=x(sn);updateAvailable=b(!1);installPromptEvent=b(null);isInstallable=b(!1);INSTALL_DISMISSED_KEY="pwa_install_dismissed";INSTALL_DISMISSED_UNTIL_KEY="pwa_install_dismissed_until";DISMISS_DURATION_DAYS=7;constructor(){this.initializeUpdateCheck(),this.initializeInstallPrompt()}initializeUpdateCheck(){if(!this.swUpdate.isEnabled){E.production||console.log("Service Worker is not enabled");return}this.swUpdate.versionUpdates.pipe(ue(e=>e.type==="VERSION_READY")).subscribe(e=>{E.production||console.log("New version available:",e.latestVersion),this.updateAvailable.set(!0)}),setInterval(()=>{this.checkForUpdate()},1800*1e3)}initializeInstallPrompt(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.installPromptEvent.set(e),this.isInstallDismissed()?E.production||console.log("PWA install prompt dismissed by user - not showing"):(this.isInstallable.set(!0),E.production||console.log("PWA install prompt available"))}),window.addEventListener("appinstalled",()=>{E.production||console.log("iBudget PWA was installed"),this.isInstallable.set(!1),this.installPromptEvent.set(null),this.clearInstallDismissed()})}async checkForUpdate(){if(!this.swUpdate.isEnabled)return!1;try{return await this.swUpdate.checkForUpdate()}catch(e){return console.error("Error checking for updates:",e),!1}}reloadToUpdate(){this.updateAvailable.set(!1),window.location.reload()}async promptInstall(){let e=this.installPromptEvent();if(!e)return E.production||console.log("Install prompt not available"),!1;e.prompt();let t=await e.userChoice;return E.production||console.log("Install prompt result:",t.outcome),this.installPromptEvent.set(null),this.isInstallable.set(!1),t.outcome==="accepted"}isRunningStandalone(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}dismissInstallPrompt(){let e=Date.now()+this.DISMISS_DURATION_DAYS*24*60*60*1e3;localStorage.setItem(this.INSTALL_DISMISSED_KEY,"true"),localStorage.setItem(this.INSTALL_DISMISSED_UNTIL_KEY,e.toString()),this.isInstallable.set(!1),E.production||console.log(`PWA install prompt dismissed until ${new Date(e).toLocaleDateString()}`)}isInstallDismissed(){let e=localStorage.getItem(this.INSTALL_DISMISSED_KEY),t=localStorage.getItem(this.INSTALL_DISMISSED_UNTIL_KEY);if(!e||!t)return!1;let o=parseInt(t,10);return Date.now()>o?(this.clearInstallDismissed(),!1):!0}clearInstallDismissed(){localStorage.removeItem(this.INSTALL_DISMISSED_KEY),localStorage.removeItem(this.INSTALL_DISMISSED_UNTIL_KEY)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"})};function yo(i,e){if(i&1){let t=A();c(0,"div",0)(1,"div",4),m(2,"i",5),c(3,"span"),f(4,"A new version of iBudget is available!"),d()(),c(5,"div",6)(6,"button",7),O("click",function(){P(t);let n=u();return M(n.dismissUpdate())}),f(7,"Later"),d(),c(8,"button",8),O("click",function(){P(t);let n=u();return M(n.reloadApp())}),f(9,"Update Now"),d()()()}}function Oo(i,e){if(i&1){let t=A();c(0,"div",1)(1,"div",9),m(2,"i",10),c(3,"span"),f(4,"Install iBudget for a better experience"),d()(),c(5,"div",11)(6,"button",12),O("click",function(){P(t);let n=u();return M(n.dismissInstall())}),f(7,"Not Now"),d(),c(8,"button",7),O("click",function(){P(t);let n=u();return M(n.installApp())}),f(9,"Install"),d()()()}}function So(i,e){i&1&&m(0,"app-chatbot-sidebar")}var Ne=class i{title=b("ibudget");chatbotService=x(Me);authService=x(F);pwaService=x(Ve);router=x(V);isOpen=this.chatbotService.isOpen;updateAvailable=this.pwaService.updateAvailable;isInstallable=this.pwaService.isInstallable;isAuthenticated=b(this.authService.isLoggedIn());constructor(){this.router.events.pipe(ue(e=>e instanceof ve)).subscribe(()=>{this.isAuthenticated.set(this.authService.isLoggedIn())})}showChatbot=Bt(()=>this.isAuthenticated());reloadApp(){this.pwaService.reloadToUpdate()}async installApp(){await this.pwaService.promptInstall()}dismissUpdate(){this.pwaService.updateAvailable.set(!1)}dismissInstall(){this.pwaService.dismissInstallPrompt()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=H({type:i,selectors:[["app-root"]],decls:7,vars:5,consts:[[1,"pwa-update-banner"],[1,"pwa-install-banner"],[1,"main-content"],["color","#4689cb","height","5px","ref","http"],[1,"pwa-update-content"],[1,"bi","bi-arrow-repeat"],[1,"pwa-update-actions"],[1,"btn","btn-sm","btn-light",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"pwa-install-content"],[1,"bi","bi-download"],[1,"pwa-install-actions"],[1,"btn","btn-sm","btn-outline-light",3,"click"]],template:function(t,o){t&1&&(m(0,"app-toast-container"),S(1,yo,10,0,"div",0),S(2,Oo,10,0,"div",1),c(3,"div",2),m(4,"ngx-loading-bar",3)(5,"router-outlet"),d(),S(6,So,1,0,"app-chatbot-sidebar")),t&2&&(p(),T(o.updateAvailable()?1:-1),p(),T(o.isInstallable()?2:-1),p(),L("sidebar-open",o.isOpen()),p(3),T(o.showChatbot()?6:-1))},dependencies:[on,wn,$e,De],styles:[".pwa-update-banner[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:linear-gradient(135deg,#4689cb,#2c5aa0);color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;z-index:9999;box-shadow:0 2px 10px #0003;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.pwa-update-banner[_ngcontent-%COMP%]   .pwa-update-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-weight:500}.pwa-update-banner[_ngcontent-%COMP%]   .pwa-update-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem;animation:_ngcontent-%COMP%_spin 2s linear infinite}.pwa-update-banner[_ngcontent-%COMP%]   .pwa-update-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.pwa-install-banner[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;right:20px;background:linear-gradient(135deg,#212529,#343a40);color:#fff;padding:16px 20px;display:flex;justify-content:space-between;align-items:center;z-index:9998;border-radius:12px;box-shadow:0 4px 20px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease-out}@media (min-width: 768px){.pwa-install-banner[_ngcontent-%COMP%]{left:auto;right:20px;max-width:400px}}.pwa-install-banner[_ngcontent-%COMP%]   .pwa-install-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-weight:500}.pwa-install-banner[_ngcontent-%COMP%]   .pwa-install-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.4rem}.pwa-install-banner[_ngcontent-%COMP%]   .pwa-install-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-shrink:0}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.main-content[_ngcontent-%COMP%]{transition:margin-right .3s ease-in-out;margin-right:0;width:100%;min-height:100%;height:auto;position:relative}.main-content.sidebar-open[_ngcontent-%COMP%]{margin-right:400px;width:calc(100% - 400px)}@media (max-width: 480px){.main-content.sidebar-open[_ngcontent-%COMP%]{margin-right:0;width:100%;display:none}}[_nghost-%COMP%]{display:block;width:100%}"]})};console.log("%cSTOP!","color: red; font-size: 72px; font-weight: bold; text-shadow: 3px 3px 0 rgb(217,31,38), 6px 6px 0 rgb(226,91,14), 9px 9px 0 rgb(245,221,8);");console.log("%cThis is a browser feature intended for developers.","font-size: 20px; font-weight: bold;");console.log('%cIf someone told you to copy-paste something here to enable an iBudget feature or "hack" an account, it is a scam and will give them access to your iBudget account.',"font-size: 18px;");Yt(Ne,In).catch(i=>console.error(i));
