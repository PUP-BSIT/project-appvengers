import{c as E}from"./chunk-NYHJAWNZ.js";import{a as R,b as h,c as N,d as F,g as V,i as T,j as I,q as D,s as z}from"./chunk-R4J5TFSL.js";import"./chunk-H4HKKKHV.js";import{B as S,C as k,h as O,z as y}from"./chunk-OQ6H4KVU.js";import{$a as b,Cb as M,Fb as C,Gb as p,La as s,Nb as P,Pb as o,Qb as v,Rb as x,Wa as w,Z as _,_ as f,ha as c,nb as m,ob as g,tb as u,ub as t,vb as n,wb as a}from"./chunk-DFJZCQ6A.js";import"./chunk-DAQOROHW.js";function A(r,i){r&1&&(t(0,"div",9)(1,"div",13)(2,"span",14),o(3,"Loading..."),n()(),t(4,"p",15),o(5,"Validating reset link..."),n()())}function q(r,i){if(r&1&&(t(0,"div",10)(1,"div",16),a(2,"i",17),n(),t(3,"h5",18),o(4,"Invalid or Expired Link"),n(),t(5,"p",19),o(6),n(),t(7,"a",20),o(8," Request New Reset Link "),n(),t(9,"div",4)(10,"a",21),a(11,"i",22),o(12," Back to Login "),n()()()),r&2){let e=p();s(6),x(" ",e.errorMessage()," ")}}function G(r,i){if(r&1&&(t(0,"div",11)(1,"div",23),a(2,"i",24),n(),t(3,"h5",18),o(4,"Password Reset Successful!"),n(),t(5,"p",19),o(6),n(),t(7,"p",25),o(8," Redirecting to login page... "),n(),t(9,"a",26),o(10," Go to Login "),n()()),r&2){let e=p();s(6),x(" ",e.successMessage()," ")}}function B(r,i){if(r&1&&(t(0,"div",28),o(1),n()),r&2){let e=p(2);s(),v(e.errorMessage())}}function j(r,i){r&1&&(t(0,"div",34),o(1," Password is required "),n())}function Y(r,i){r&1&&(t(0,"div",34),o(1," Password must be at least 8 characters "),n())}function H(r,i){r&1&&(t(0,"div",34),o(1," Please confirm your password "),n())}function J(r,i){r&1&&(t(0,"div",34),o(1," Passwords do not match "),n())}function K(r,i){r&1&&(a(0,"span",38),o(1," Resetting Password... "))}function Q(r,i){r&1&&o(0," Reset Password ")}function U(r,i){if(r&1){let e=M();t(0,"form",27),C("ngSubmit",function(){_(e);let l=p();return f(l.onSubmit())}),m(1,B,2,1,"div",28),t(2,"div",18)(3,"label",29),o(4,"New Password"),n(),t(5,"div",30),a(6,"input",31),t(7,"button",32),C("click",function(){_(e);let l=p();return f(l.hideNewPassword.set(!l.hideNewPassword()))}),a(8,"i",33),n()(),m(9,j,2,0,"div",34),m(10,Y,2,0,"div",34),n(),t(11,"div",18)(12,"label",35),o(13,"Confirm Password"),n(),t(14,"div",30),a(15,"input",36),t(16,"button",32),C("click",function(){_(e);let l=p();return f(l.hideConfirmPassword.set(!l.hideConfirmPassword()))}),a(17,"i",33),n()(),m(18,H,2,0,"div",34),m(19,J,2,0,"div",34),n(),t(20,"button",37),m(21,K,2,0)(22,Q,1,0),n(),t(23,"div",4)(24,"a",21),a(25,"i",22),o(26," Back to Login "),n()()()}if(r&2){let e=p();u("formGroup",e.resetPasswordForm),s(),g(e.errorMessage()?1:-1),s(5),P("is-invalid",(e.newPassword==null?null:e.newPassword.invalid)&&(e.newPassword==null?null:e.newPassword.touched)),u("type",e.hideNewPassword()?"password":"text"),s(2),P("bi-eye",!e.hideNewPassword())("bi-eye-slash",e.hideNewPassword()),s(),g(e.newPassword!=null&&e.newPassword.hasError("required")&&(e.newPassword!=null&&e.newPassword.touched)?9:-1),s(),g(e.newPassword!=null&&e.newPassword.hasError("minlength")&&(e.newPassword!=null&&e.newPassword.touched)?10:-1),s(5),P("is-invalid",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&(e.confirmPassword==null?null:e.confirmPassword.touched)||e.resetPasswordForm.hasError("passwordMismatch")),u("type",e.hideConfirmPassword()?"password":"text"),s(2),P("bi-eye",!e.hideConfirmPassword())("bi-eye-slash",e.hideConfirmPassword()),s(),g(e.confirmPassword!=null&&e.confirmPassword.hasError("required")&&(e.confirmPassword!=null&&e.confirmPassword.touched)?18:-1),s(),g(e.resetPasswordForm.hasError("passwordMismatch")&&(e.confirmPassword!=null&&e.confirmPassword.touched)?19:-1),s(),u("disabled",e.submitting()||e.resetPasswordForm.invalid),s(),g(e.submitting()?21:22)}}var L=class r{constructor(i,e,d,l){this.fb=i;this.authService=e;this.route=d;this.router=l;this.resetPasswordForm=this.fb.group({newPassword:["",[h.required,h.minLength(8)]],confirmPassword:["",[h.required]]},{validators:this.passwordMatchValidator})}resetPasswordForm;token=c("");tokenValid=c(!1);loading=c(!0);submitting=c(!1);errorMessage=c("");successMessage=c("");hideNewPassword=c(!0);hideConfirmPassword=c(!0);ngOnInit(){this.route.queryParams.subscribe(i=>{let e=i.token;e?(this.token.set(e),this.validateToken(e)):(this.loading.set(!1),this.errorMessage.set("Invalid password reset link"))})}passwordMatchValidator(i){let e=i.get("newPassword"),d=i.get("confirmPassword");return!e||!d||e.value===d.value?null:{passwordMismatch:!0}}get newPassword(){return this.resetPasswordForm.get("newPassword")}get confirmPassword(){return this.resetPasswordForm.get("confirmPassword")}validateToken(i){this.authService.validateResetToken(i).subscribe({next:e=>{this.tokenValid.set(e.success),this.loading.set(!1),e.success||this.errorMessage.set(e.message)},error:e=>{this.tokenValid.set(!1),this.loading.set(!1),this.errorMessage.set(e.error?.message||"Invalid or expired reset token")}})}onSubmit(){if(this.resetPasswordForm.invalid)return;this.submitting.set(!0),this.errorMessage.set("");let i={token:this.token(),newPassword:this.resetPasswordForm.value.newPassword,confirmPassword:this.resetPasswordForm.value.confirmPassword};this.authService.resetPassword(i).subscribe({next:e=>{this.submitting.set(!1),e.success?(this.successMessage.set(e.message),setTimeout(()=>{this.router.navigate(["/auth-page"])},3e3)):this.errorMessage.set(e.message)},error:e=>{this.submitting.set(!1),this.errorMessage.set(e.error?.message||"Failed to reset password. Please try again.")}})}static \u0275fac=function(e){return new(e||r)(w(D),w(E),w(y),w(S))};static \u0275cmp=b({type:r,selectors:[["app-reset-password"]],decls:15,vars:1,consts:[[1,"reset-password-container"],[1,"card","reset-password-card"],[1,"card-body"],[1,"reset-password-header","text-center","mb-4"],[1,"text-center"],[1,"fw-bold","custom-title"],["src","assets/images/coin.png","alt","iBudget Logo"],[1,"mt-3"],[1,"text-muted"],[1,"loading-container","text-center","py-5"],[1,"error-container","text-center"],[1,"success-container","text-center"],[1,"reset-password-form",3,"formGroup"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","mt-3"],[1,"error-icon","mb-3"],[1,"bi","bi-x-circle-fill","text-danger",2,"font-size","4rem"],[1,"mb-3"],[1,"text-muted","mb-4"],["routerLink","/forgot-password",1,"btn","btn-primary","w-100","mb-3"],["routerLink","/login",1,"text-decoration-none"],[1,"bi","bi-arrow-left","me-1"],[1,"success-icon","mb-3"],[1,"bi","bi-check-circle-fill","text-success",2,"font-size","4rem"],[1,"text-muted","small","mb-4"],["routerLink","/login",1,"btn","btn-primary","w-100"],[1,"reset-password-form",3,"ngSubmit","formGroup"],[1,"alert","alert-danger"],["for","newPassword",1,"form-label"],[1,"input-group"],["id","newPassword","formControlName","newPassword","placeholder","Enter new password",1,"form-control",3,"type"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi"],[1,"text-danger","small","mt-1"],["for","confirmPassword",1,"form-label"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm new password",1,"form-control",3,"type"],["type","submit",1,"btn","btn-primary","w-100","mb-3",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(e,d){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),a(6,"img",6),n()(),t(7,"h4",7),o(8,"Reset Password"),n(),t(9,"p",8),o(10," Please enter your new password below. "),n()(),m(11,A,6,0,"div",9)(12,q,13,1,"div",10)(13,G,11,1,"div",11)(14,U,27,22,"form",12),n()()()),e&2&&(s(11),g(d.loading()?11:d.tokenValid()?d.successMessage()?13:14:12))},dependencies:[O,z,V,R,N,F,T,I,k],styles:[".reset-password-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#2d5a87;padding:20px}.reset-password-card[_ngcontent-%COMP%]{width:100%;max-width:450px;border:none;border-radius:15px;box-shadow:0 10px 40px #0003}.reset-password-header[_ngcontent-%COMP%]   .custom-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px}.reset-password-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#1f2937;font-weight:600}.reset-password-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.loading-container[_ngcontent-%COMP%]   .spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.reset-password-form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:500;color:#4b5563;margin-bottom:.5rem}.reset-password-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #d1d5db;border-right:none}.reset-password-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:none}.reset-password-form[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.reset-password-form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]{border:1px solid #d1d5db;border-left:none;background-color:#f9fafb;color:#6b7280}.reset-password-form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#e5e7eb;color:#4b5563}.reset-password-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;padding:.75rem;font-weight:600;border-radius:8px;transition:transform .2s}.reset-password-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 12px #667eea66}.reset-password-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.success-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{padding:2rem 0}.success-container[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%], .success-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_scaleIn .3s ease-out}.success-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#1f2937;font-weight:600}.success-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);border:none;padding:.55rem;margin:10px 0 0;font-weight:600;border-radius:8px;transition:transform .2s}.success-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover, .error-container[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 12px #667eea66}.alert-danger[_ngcontent-%COMP%]{border-radius:8px;font-size:14px}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}@media (max-width: 991px){.reset-password-card[_ngcontent-%COMP%]{max-width:380px;padding:18px}.reset-password-header[_ngcontent-%COMP%]   .custom-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:48px;height:48px}}@media (max-width: 768px){.reset-password-container[_ngcontent-%COMP%]{padding:10px}.reset-password-card[_ngcontent-%COMP%]{max-width:95vw;padding:14px;margin:8px auto}.reset-password-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.1rem}.reset-password-header[_ngcontent-%COMP%]   .custom-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}}@media (max-width: 425px){.reset-password-container[_ngcontent-%COMP%]{padding:4px}.reset-password-card[_ngcontent-%COMP%]{max-width:100vw;padding:8px;margin:4px auto;border-radius:10px}.reset-password-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem}.reset-password-header[_ngcontent-%COMP%]   .custom-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px}.reset-password-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.95rem}.success-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 320px){.reset-password-card[_ngcontent-%COMP%]{padding:4px;margin:2px auto;border-radius:7px}.reset-password-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.95rem}.reset-password-header[_ngcontent-%COMP%]   .custom-title[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}.reset-password-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:.4rem .5rem;font-size:.85rem}.success-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:.95rem}}"]})};export{L as ResetPassword};
