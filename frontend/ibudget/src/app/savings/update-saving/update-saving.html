<app-toggleable-sidebar/>
<app-header/>

<main>
  <div class="form-container">
    <h2>Update Saving</h2>
    <p>Fill in the details below to update your saving goal.</p>
  
    <form [formGroup]="updateSavingForm">
      <div class="first-row">
        <div class="mb-3">
          <label for="saving_name" class="form-label">Saving Name</label>
          <div class="input-group">
            <i class="bi bi-piggy-bank input-group-text"></i>
            <input 
              type="text" 
              class="form-control" 
              id="saving_name" 
              formControlName="name"
              placeholder="Enter saving name"/>
          </div>

          <!-- Validator Indicator -->
          @if(updateSavingForm.get('name')?.touched && 
            updateSavingForm.get('name')?.invalid) 
          {
            <div class="text-danger mt-1">
              Saving Name is required.
            </div>
          }
        </div>
    
        <div class="mb-3">
          <label for="target_amount" class="form-label">Target Amount</label>
          <div class="input-group">
            <i class="bi bi-currency-dollar input-group-text"></i>
            <input 
              type="number" 
              class="form-control" 
              id="target_amount" 
              formControlName="target_amount"
              placeholder="Enter target amount"/>
          </div>

          <!-- Validator Indicator -->
          @if(updateSavingForm.get('target_amount')?.touched && 
            updateSavingForm.get('target_amount')?.invalid)
          {
            @if(updateSavingForm.get('target_amount')?.errors?.['required']) {
              <div class="text-danger mt-1">
                Target Amount is required.
              </div>
            } @else if(updateSavingForm.get('target_amount')?.errors?.['min']) {
              <div class="text-danger mt-1">
                Target Amount must be at least 1.
              </div>
            }
          }
        </div>
      </div>
      
      <div class="second-row">
        <div class="mb-3">
          <label for="frequency" class="form-label">Frequency</label>
          <div class="input-group">
            <i class="bi bi-clock-history input-group-text"></i>
            <select 
                class="form-select" 
                id="frequency" 
                formControlName="frequency">
              <option value="" disabled selected>Select frequency</option>
              <option value="Daily">Daily</option>
              <option value="Weekly">Weekly</option>
              <option value="Monthly">Monthly</option>
            </select>
          </div>


          <!-- Validator Indicator -->
          @if(updateSavingForm.get('frequency')?.touched &&
            updateSavingForm.get('frequency')?.invalid) 
          {
            <div class="text-danger mt-1">
              Frequency is required.
            </div>
          }
        </div>

        <div class="mb-3">
          <label for="goal_date" class="form-label">Goal Date</label>
          <div class="input-group">
            <i class="bi bi-calendar-event input-group-text"></i>
            <input 
            type="date" 
            class="form-control" 
            formControlName="goal_date"
            id="goal_date"/>
          </div>

          <!-- Validator Indicator -->
          @if(updateSavingForm.get('goal_date')?.touched &&
            updateSavingForm.get('goal_date')?.invalid) 
          {
            @if(updateSavingForm.get('goal_date')?.errors?.['required']) {
              <div class="text-danger mt-1">
                Goal Date is required.
              </div>
            } @else if(updateSavingForm.get('goal_date')?.errors?.['pastDate']) {
              <div class="text-danger mt-1">
                Goal Date must be in the future.
              </div>
            }
          }
        </div>
      </div>

      <!-- Header Color based on Bootstrap Colors -->
      <div class="mb-3">
        <label for="header_color" class="form-label">Header Color</label>
        <select class="form-select" formControlName="header_color" id="header_color">
          <option value="" disabled selected>Select a color</option>
          <option value="bg-dark">Dark (Default)</option>
          <option value="bg-yellow">Yellow</option>
          <option value="bg-danger">Red</option>
          <option value="bg-success">Green</option>
          <option value="bg-primary">Blue</option>
        </select>
      </div>

      <div>
        <label for="description" class="form-label">Description</label>
        <textarea 
          class="form-control" 
          id="description" 
          rows="3"
          formControlName="description"
          placeholder="Enter description (optional)"></textarea>
      </div>
  
      <div class="actions-container d-flex gap-2 align-items-center mt-2">
        <button 
          class="btn btn-secondary"
          routerLink="/savings">
            Cancel
        </button>

        <button 
          type="button" 
          class="btn btn-primary"
          (click)="updateSaving()">
            Update
        </button>
      </div>
    </form>
  </div>
</main>