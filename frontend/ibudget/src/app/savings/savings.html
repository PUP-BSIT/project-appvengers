<app-header/>
<app-sidebar/>

<main>
  <div class="inner-wrapper">
    <div class="actions-container">
      <div>
        <h3>Savings</h3>
        <p class="text-secondary">
          Manage your savings goals and track your progress.
        </p>
      </div>

      <div>
        <button 
          class="btn btn-success"
          routerLink="/savings/add-saving">
            Add New Saving
        </button>
      </div>
    </div>
    
    <div class="savings-container">
      @if(isLoading()) {
        <div class="loading-spinner-container">
          <div class="spinner-border text-primary" role="status"></div>
        </div>
      } @else if(savings().length === 0) {
        <p class="no-savings-message">
          No savings goals found. Click "Add New Saving" to create one.
        </p>
      }
      
      @for(saving of savings(); track saving.saving_id) {
        <div class="card m-2">
          <div class="card-header bg-dark text-white">
            <h5 class="card-title">{{ saving.name }}</h5>
          </div>

          <div class="card-body">
            <p class="card-text">{{ saving.description }}</p>

            <div class="progress-information">
              <label>Progress</label>
              <h6>{{ getProgressPercentage(saving) }}%</h6>
            </div>

            <div class="saving-progress-container">
              <app-saving-progress 
                [progressPercentage]="getProgressPercentage(saving)"/>
            </div>

            <div class="progress-information  mt-2">
              <p>&#8369; {{ saving.current_amount | number:'1.0-0' }}</p>
              <p>&#8369; {{ saving.target_amount | number:'1.0-0' }}</p>
            </div>

            <div class="progress-information">
              <label>Goal Date</label>
              <h6>{{ saving.goal_date | date: 'MMM d, y' }}</h6>
            </div>
          </div>

          <div class="card-footer d-flex bg-white p-3">
            <button 
              class="btn btn-primary w-100"
              [routerLink]="'/savings/view-saving/' + saving.saving_id">
                View Details
            </button>
          </div>
        </div>
      }
    </div>

    <!-- Success Toast -->
    <div class="toast-container">
      <div #savingsToast class="toast align-items-center text-bg-success border-0">
        <div class="d-flex justify-content-between">
          <div class="toast-body" role="alert">
            <span>{{ toastMessage() }}</span>
          </div>

          <button 
            type="button" 
            class="btn-close btn-close-white me-2 m-auto" 
            data-bs-dismiss="toast" 
            aria-label="Close">
          </button>
        </div>
      </div>
    </div>
  </div>
</main>