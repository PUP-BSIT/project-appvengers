<app-sidebar/>
<app-header/>

<main>
  <!-- Key Performance Indicator Panel -->
  <app-kpi-panel/>

  <!-- Budgets Transactions Goes Here -->
  <div class="expenses-history-container">
    <div class="title-actions-container">      
      <div>
        <h4>Expenses History</h4>
      </div>

      <div>
        <app-add-budget-expense
        [categories]="categories()"
        (addBudgetExpenseResponse)="onBudgetExpenseAdded($event)"/>
      </div>
    </div>

    <div class="expenses-table-container">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Date</th>
            <th scope="col">Description</th>
            <th scope="col">Category</th>
            <th scope="col">Amount</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          @if(budgetExpenses().length === 0) {
            <tr>
              <td colspan="5" class="text-center">
                No budget expenses found.
              </td>
            </tr>
          } @else {
              @for(transaction of budgetExpenses(); track $index) {
              <tr>
                <td>{{ transaction.transactionDate }}</td>
                <td>{{ transaction.description }}</td>
                <td>&#8369; {{ transaction.amount }}</td>
                <td>
                  <app-update-budget-expense
                  [transactionId]="transaction.transactionId"
                  (updateBudgetExpenseResponse)="onBudgetExpenseUpdated($event)"/>

                  <button 
                    class="btn btn-sm btn-danger" 
                    (click)="deleteBudgetExpense(transaction.transactionId)">
                    Delete
                  </button>
              </tr>
            }
          }
        </tbody>
      </table>
    </div>
  </div>
</main>
